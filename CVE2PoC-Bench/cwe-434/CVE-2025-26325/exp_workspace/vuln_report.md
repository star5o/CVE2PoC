# CVE-2025-26325 Vulnerability Report

## Overview

**CVE ID:** CVE-2025-26325  
**Affected Software:** ShopXO  
**Affected Version:** 6.4.0  
**Vulnerability Type:** Unrestricted File Upload (CWE-434)  
**CVSS Score:** 9.8 (Critical)

## Vulnerability Description

ShopXO 6.4.0 is vulnerable to arbitrary file upload in ThemeDataService.php. The `ThemeDataUploadHandle` function processes uploaded ZIP files for theme data import without properly validating file extensions of extracted files.

Although the code defines `$exclude_ext = ['php']` to exclude PHP files, this check is only applied when processing `config.json` files and not when extracting other files from the ZIP archive.

## Vulnerable Code

Location: `app/service/ThemeDataService.php`

The vulnerability exists in the `ThemeDataUploadHandle` function (line 1687-1878). The file extraction logic at lines 1806-1868 does not validate file extensions:

```php
// File processing without extension check
for($i=0; $i<$zip->numFiles; $i++)
{
    $file = $zip->getNameIndex($i);
    // ... path processing ...
    
    // Files are written without extension validation
    if(!is_dir($new_file))
    {
        $stream = $zip->getStream($file);
        if($stream !== false)
        {
            $file_content = stream_get_contents($stream);
            if($file_content !== false)
            {
                file_put_contents($new_file, $file_content);  // No extension check!
            }
        }
    }
}
```

## Exploitation

An authenticated admin user can upload a malicious ZIP file containing a PHP webshell through the theme data upload feature. The ZIP structure exploits the path handling logic to write files to the web root:

1. Create a ZIP with structure: `{unique}/{unique}/shell.php`
2. Upload via `themedata/upload` endpoint
3. The file is extracted to `/public/shell.php`

## Impact

- Remote Code Execution (RCE)
- Full server compromise
- Data theft and manipulation

## Proof of Concept

See `poc.py` for the exploitation script.

## Remediation

1. Implement proper file extension validation during ZIP extraction
2. Use allowlist for permitted file types
3. Store uploaded files outside the web root
4. Apply the `$exclude_ext` check to all extracted files

## References

- https://github.com/gongfuxiang/shopxo/issues/86
- https://nvd.nist.gov/vuln/detail/CVE-2025-26325
