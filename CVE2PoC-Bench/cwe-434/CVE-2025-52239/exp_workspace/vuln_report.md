# CVE-2025-52239 Vulnerability Report

## Overview

- **CVE ID**: CVE-2025-52239
- **Affected Software**: ZKEACMS v4.1
- **Vulnerability Type**: CWE-434 (Unrestricted Upload of File with Dangerous Type)
- **CVSS Score**: 9.8 (Critical)
- **Verification Status**: CONFIRMED

## Vulnerability Description

An arbitrary file upload vulnerability in ZKEACMS v4.1 allows authenticated attackers to upload files with dangerous extensions due to an incomplete blacklist validation.

## Technical Analysis

### Blacklist Implementation

Location: `src/EasyFrameWork/Mvc/Common.cs`

```csharp
static HashSet<string> _dangerFiles = new HashSet<string>(StringComparer.OrdinalIgnoreCase) {
    ".aspx", ".asp", ".exe", ".php", ".jsp", ".htm", ".html", 
    ".xhtml", ".cs", ".bat", ".jar", ".dll", ".com"
};
```

### Missing Dangerous Extensions

The following extensions are NOT blocked:
- `.ashx` - ASP.NET HTTP Handler
- `.asmx` - ASP.NET Web Service
- `.cshtml` - Razor view files
- `.config` - Configuration files
- `.svg` - SVG files (in image whitelist, can contain JavaScript)

## Proof of Concept Results

### Successfully Uploaded Files

| File | Extension | URL | Impact |
|------|-----------|-----|--------|
| poc_xss.svg | .svg | /UpLoad/Images/202602/b5l5k26ettds.svg | Stored XSS |
| poc_handler.ashx | .ashx | /UpLoad/Files/202602/b5l5kwyeaeww.ashx | Potential RCE |

### SVG XSS Payload

```xml
<svg xmlns="http://www.w3.org/2000/svg"><script>alert("XSS-CVE-2025-52239")</script></svg>
```

File uploaded and publicly accessible - JavaScript executes when viewed.

## Exploitation Steps

1. Login to ZKEACMS admin panel at `/account/login`
   - Default credentials: admin/admin
   - CAPTCHA required for web login
   
2. Navigate to Media Library (`/admin/Media`)

3. Upload malicious files:
   - SVG with JavaScript for XSS
   - .ashx/.cshtml for potential code execution

4. Access uploaded files directly via URL

## Impact

- **Stored XSS**: Malicious SVG files execute JavaScript in victim's browser
- **Session Hijacking**: Steal admin session cookies
- **Defacement**: Modify website content
- **Potential RCE**: If server processes .ashx files (requires specific configuration)

## Note on Authentication

The CVSS score indicates PR:N (no privileges required), but:
- Web login requires CAPTCHA
- API endpoint `/api/account/CreateToken` bypasses CAPTCHA (returns JWT)
- JWT token is NOT accepted by Media upload endpoint
- Default credentials (admin/admin) are publicly known

This suggests the vulnerability requires admin access, but with default credentials being well-known, the practical risk is high.

## Remediation

1. Use whitelist instead of blacklist for file types
2. Validate file content (magic bytes), not just extension
3. Add Content-Security-Policy headers to prevent script execution
4. Store uploads outside webroot
5. Change default admin credentials

## References

- https://github.com/SeriaWei/ZKEACMS
- https://nvd.nist.gov/vuln/detail/CVE-2025-52239
- https://cwe.mitre.org/data/definitions/434.html
