#!/bin/bash
SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
SOURCE_DIR="${SCRIPT_DIR}/source_code"

REPO_URL="https://github.com/jishenghua/jshERP.git"
VULNERABLE_COMMIT="fbda24da"

if [ -d "$SOURCE_DIR" ]; then
    echo "Source code directory already exists, removing..."
    rm -rf "$SOURCE_DIR"
fi

echo "Cloning jshERP repository..."
git clone "$REPO_URL" "$SOURCE_DIR"

cd "$SOURCE_DIR" || exit 1

echo "Checking out vulnerable commit: $VULNERABLE_COMMIT"
git checkout "$VULNERABLE_COMMIT"

echo "Done. Source code is at: $SOURCE_DIR"
