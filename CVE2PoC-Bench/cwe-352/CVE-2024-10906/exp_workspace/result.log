============================================================
CVE-2024-10906: DB-GPT CSRF Vulnerability PoC
============================================================

[*] Target: http://127.0.0.1:5670

[*] Testing Origin: https://attacker.example.com
    Response Status: 200
    Access-Control-Allow-Origin: https://attacker.example.com
    Access-Control-Allow-Credentials: true
    [+] Origin https://attacker.example.com is ALLOWED

[*] Testing Origin: https://evil-site.com
    Response Status: 200
    Access-Control-Allow-Origin: https://evil-site.com
    Access-Control-Allow-Credentials: true
    [+] Origin https://evil-site.com is ALLOWED

[*] Testing Origin: http://localhost:8080
    Response Status: 200
    Access-Control-Allow-Origin: http://localhost:8080
    Access-Control-Allow-Credentials: true
    [+] Origin http://localhost:8080 is ALLOWED

[+] VULNERABLE: Server allows cross-origin requests from any origin
[+] The CORS configuration allows_origins=['*'] with allow_credentials=True
[+] This reflects any Origin header, enabling CSRF attacks

[*] Testing actual cross-origin GET request...
[*] GET Response Status: 404
[*] GET Access-Control-Allow-Origin: *

============================================================
Result: VULNERABLE

