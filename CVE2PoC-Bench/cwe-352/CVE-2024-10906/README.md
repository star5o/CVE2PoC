# CVE-2024-10906: DB-GPT CSRF Vulnerability

## Overview

DB-GPT v0.6.0 contains a Cross-Site Request Forgery (CSRF) vulnerability due to an overly permissive CORS configuration. The `CORSMiddleware` sets `Access-Control-Allow-Origin` to `*` with `allow_credentials=True`, allowing any website to make authenticated cross-origin requests.

## Environment Setup

### Requirements

- Docker
- Docker Compose

### Build and Start

```bash
cd /path/to/CVE-2024-10906
docker-compose up -d
```

The first run will take several minutes to download the official image (~8GB) and install dependencies.

### Verify Service is Running

```bash
curl http://127.0.0.1:5670/
```

Wait until the service responds (may take 1-2 minutes after container starts).

### Stop Environment

```bash
docker-compose down
```

## Vulnerable Code

The vulnerability is in `dbgpt/app/dbgpt_server.py`:

```python
cors_app = CORSMiddleware(
    app=app,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["GET", "POST", "PUT", "PATCH", "DELETE", "OPTIONS"],
    allow_headers=["*"],
)
```

This configuration allows any origin to make requests, reflecting the Origin header back, which enables CSRF attacks from malicious websites.
