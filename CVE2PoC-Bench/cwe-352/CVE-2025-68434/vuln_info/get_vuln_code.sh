#!/bin/bash

REPO_URL="https://github.com/opensourcepos/opensourcepos.git"
VULN_TAG="3.4.1"
TARGET_DIR="$(dirname "$0")/source_code"

if [ -d "$TARGET_DIR" ]; then
    echo "Directory $TARGET_DIR already exists"
    cd "$TARGET_DIR"
    git fetch --all --tags
    git checkout "$VULN_TAG"
else
    git clone "$REPO_URL" "$TARGET_DIR"
    cd "$TARGET_DIR"
    git checkout "$VULN_TAG"
fi

echo "Checked out to $VULN_TAG"
git log -1 --oneline
