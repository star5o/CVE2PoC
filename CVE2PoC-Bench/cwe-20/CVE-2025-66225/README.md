# CVE-2025-66225 - OrangeHRM Password Reset Account Takeover

## Environment Setup

### Start Services

```bash
docker-compose up -d
```

Wait for services to initialize (about 2-3 minutes).

### Initial Installation

```bash
docker exec orangehrm-vuln bash -c 'cat > /var/www/html/installer/cli_install_config.yaml << "EOF"
database:
  hostName: mariadb
  hostPort: 3306
  databaseName: orangehrm
  privilegedDatabaseUser: root
  privilegedDatabasePassword: root123
  useSameDbUserForOrangeHRM: n
  orangehrmDatabaseUser: orangehrm
  orangehrmDatabasePassword: orangehrm123
  isExistingDatabase: y
  enableDataEncryption: n

organization:
  name: TestOrg
  country: US

admin:
  adminUserName: admin
  adminPassword: Admin@123
  adminEmployeeFirstName: Test
  adminEmployeeLastName: Admin
  workEmail: admin@test.com
  contactNumber: ""
  registrationConsent: true

license:
  agree: y
EOF'

docker exec orangehrm-vuln bash -c 'cd /var/www/html && php installer/cli_install.php'
```

### Configure Email Server

After installation, configure OrangeHRM to use MailHog:

1. Login as admin at http://localhost:8080
2. Navigate to Admin > Configuration > Email Configuration
3. Configure SMTP settings:
   - Mail Sent As: admin@test.com
   - Sending Method: SMTP
   - SMTP Host: mailhog
   - SMTP Port: 1025
   - SMTP Authentication: No
4. Click Save and Send Test Email

MailHog web interface: http://localhost:8025

### Create Test Users

1. Navigate to Admin > User Management > Users
2. Add a new user (attacker):
   - Employee Name: Create new employee first via PIM > Add Employee
   - Username: attacker
   - User Role: ESS
   - Status: Enabled
   - Password: Attacker@123
3. Set work email for attacker employee via PIM > Employee List > Edit

### Access Application

- OrangeHRM: http://localhost:8080
- MailHog: http://localhost:8025

Default credentials:
- Username: admin
- Password: Admin@123

### Stop Services

```bash
docker-compose down
docker-compose down -v  # Also removes volumes
```
