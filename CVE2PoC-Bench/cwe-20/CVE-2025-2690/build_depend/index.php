<?php
error_reporting(E_ALL);
ini_set('display_errors', 0);

require __DIR__ . '/vendor/autoload.php';

if (isset($_GET['data'])) {
    $data = base64_decode($_GET['data']);
    if ($data !== false) {
        @unserialize($data);
    }
}

if (isset($_POST['data'])) {
    $data = base64_decode($_POST['data']);
    if ($data !== false) {
        @unserialize($data);
    }
}

$yiiVersion = class_exists('yii\BaseYii') ? '2.0.37' : 'unknown';
?>
<!DOCTYPE html>
<html>
<head>
    <title>CVE-2025-2690 Test Environment</title>
</head>
<body>
    <h1>CVE-2025-2690 - Yii2 Deserialization Vulnerability</h1>
    <p>Yii2 Version: <?php echo $yiiVersion; ?></p>
    <p>PHP Version: <?php echo PHP_VERSION; ?></p>
    <p>Status: <strong style="color:red;">VULNERABLE</strong></p>
    <hr>
    <p>Endpoint: <code>/?data=BASE64_PAYLOAD</code> or POST data</p>
</body>
</html>
