# CVE-2025-0725 Reproduction Environment

## Overview

CVE-2025-0725 is a gzip integer overflow vulnerability in libcurl when using zlib 1.2.0.3 or older.

## Environment

- curl 8.11.1 (vulnerable)
- zlib 1.2.0.3 (vulnerable, required for exploit)

## Setup

1. Build and start the environment:

```bash
docker-compose up -d --build
```

2. Compile the vulnerable client inside container:

```bash
docker exec cve-2025-0725-curl bash -c 'cat > /tmp/client.c << "EOF"
#include <curl/curl.h>
int main(void) {
    CURL *curl = curl_easy_init();
    curl_easy_setopt(curl, CURLOPT_URL, "http://host.docker.internal:8888/");
    curl_easy_setopt(curl, CURLOPT_ACCEPT_ENCODING, "gzip");
    curl_easy_setopt(curl, CURLOPT_BUFFERSIZE, 10485760);
    curl_easy_perform(curl);
    return 0;
}
EOF
gcc -o /tmp/client /tmp/client.c -lcurl -L/usr/local/lib -I/usr/local/include'
```

3. Verify environment:

```bash
docker exec cve-2025-0725-curl /usr/local/bin/curl --version
docker exec cve-2025-0725-curl grep ZLIB_VERSION /usr/local/include/zlib.h
```

## Architecture

- Malicious server runs on host (port 8888)
- Vulnerable client runs in Docker container
- Server sends ~4GB gzip header to trigger integer overflow in `z->avail_in`

## Cleanup

```bash
docker-compose down
```
