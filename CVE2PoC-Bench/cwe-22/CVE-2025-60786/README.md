# CVE-2025-60786 Reproduction Environment

## Environment Startup

1.  Navigate to the directory `CWE-22/CVE-2025-60786`.
2.  Start the environment using Docker Compose:
    ```bash
    docker-compose up -d --build
    ```
3.  The application will be available at `http://localhost:8080/icescrum`.

## Initialization Steps

1.  Access `http://localhost:8080/icescrum`. You will be redirected to the setup wizard.
2.  Follow the setup wizard steps (click "Next" for most steps):
    -   **Welcome**: Click Next.
    -   **Admin Account**:
        -   Username: `admin`
        -   Email: `admin@example.com`
        -   Password: `Admin123!`
        -   Confirm Password: `Admin123!`
        -   Click Next.
    -   **Directories and logs**: Keep defaults (`/root/icescrum`, `/root/logs/`). Click Next.
    -   **License**: Check "Skip Free trial". Click Next.
    -   **Database**: Keep defaults (H2). Click Next.
    -   **Mail**: Keep defaults. Click Next.
    -   **iceScrum access**: Keep default URL (`http://localhost:8080/icescrum`). Click Next.
    -   **User groups**: Keep defaults. Click Next.
    -   **Project groups**: Keep defaults. **Ensure "Enable project import" is checked** (default is checked). Click Next.
    -   **Commit configuration**: Click "Submit configuration file".
3.  After submission, restart the container to apply changes:
    ```bash
    docker restart cve-2025-60786-icescrum-1
    ```
4.  Access `http://localhost:8080/icescrum` again. You should see the login page.
5.  Login with the admin credentials created in step 2 (`admin` / `Admin123!`).

## Verification

1.  Run the verification script:
    ```bash
    python3 exp_workspace/poc.py
    ```
2.  The script will:
    -   Log in as admin.
    -   Create a malicious ZIP file containing a file with path traversal (`../../../../../../../../tmp/pwned_cve_2025_60786`).
    -   Upload the ZIP via the Project Import functionality (`/project/import`).
    -   Verify if the file exists at `/tmp/pwned_cve_2025_60786` inside the container.
3.  Check `result.log` for the outcome.
