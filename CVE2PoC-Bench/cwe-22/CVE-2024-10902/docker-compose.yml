services:
  webserver:
    image: eosphorosai/dbgpt:v0.6.0
    container_name: dbgpt-cve-2024-10902
    command: python3 dbgpt/app/dbgpt_server.py --light
    environment:
      - LOCAL_DB_TYPE=sqlite
      - LLM_MODEL=proxyllm
      - PROXY_API_KEY=fake_key_for_poc
      - PROXY_SERVER_URL=http://localhost:8080/fake
      - LANGUAGE=en
      - WEBSERVER_REMOTE_EMBEDDING=True
      - WEBSERVER_LIGHT=True
    ports:
      - "5670:5670"
    volumes:
      - dbgpt-data:/app/pilot/data
      - dbgpt-plugins:/app/plugins
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5670"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 60s

volumes:
  dbgpt-data:
  dbgpt-plugins:
