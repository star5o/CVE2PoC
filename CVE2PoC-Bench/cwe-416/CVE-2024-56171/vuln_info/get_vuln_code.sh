#!/bin/bash
VULN_TAG="v2.12.9"
REPO_URL="https://github.com/GNOME/libxml2.git"
TARGET_DIR="$(dirname "$0")/source_code"

echo "[*] Fetching libxml2 ${VULN_TAG}..."

if [ -d "${TARGET_DIR}" ]; then
    rm -rf "${TARGET_DIR}"
fi

git clone --depth 1 --branch "${VULN_TAG}" "${REPO_URL}" "${TARGET_DIR}"

if [ $? -eq 0 ]; then
    echo "[+] Source code saved to: ${TARGET_DIR}"
    cd "${TARGET_DIR}" && git describe --tags 2>/dev/null
else
    echo "[-] Failed to fetch source code"
    exit 1
fi
