# CVE-2025-57807 - ImageMagick Heap Buffer Overflow

## Overview

- **CVE ID**: CVE-2025-57807
- **CWE**: CWE-122 (Heap-based Buffer Overflow)
- **CVSS**: 9.8 (Critical)
- **Affected Version**: ImageMagick < 14.8.2 (using 7.1.2-0)
- **Fixed Version**: 14.8.2, 7.1.2-3, 6.9.13-29

## Environment Setup

### 1. Start the vulnerable environment

```bash
cd cwe-122/CVE-2025-57807
docker-compose up -d --build
```

### 2. Verify the service is running

Open browser and visit: http://localhost:8888

The page should display ImageMagick version information (7.1.2-0).

### 3. Stop the environment

```bash
docker-compose down
```

## Technical Details

The vulnerability exists in `MagickCore/blob.c`:
- `SeekBlob()` permits advancing the stream offset beyond current end without increasing capacity
- `WriteBlob()` expands by `quantum + length` instead of `offset + length`
- When `offset >> extent`, the copy targets memory beyond allocation

## References

- https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-23hg-53q6-hqfg
- https://nvd.nist.gov/vuln/detail/CVE-2025-57807
