FROM node:18-alpine

WORKDIR /app

RUN apk add --no-cache git

RUN git clone --depth 1 --branch app-ziti-console-v3.7.0 https://github.com/openziti/ziti-console.git .

RUN npm install

RUN npm install -g @angular/cli@16

RUN ng build ziti-console-node

ENV ALLOW_HTTP=true
ENV PORT=1408

EXPOSE 1408

CMD ["node", "server.js"]
