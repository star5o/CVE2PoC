#!/bin/bash
REPO_URL="https://github.com/flatpressblog/flatpress.git"
VULNERABLE_TAG="1.2.1"
SOURCE_DIR="$(dirname "$0")/source_code"

if [ -d "$SOURCE_DIR" ]; then
    echo "Source code directory already exists, removing..."
    rm -rf "$SOURCE_DIR"
fi

echo "Cloning FlatPress repository..."
git clone --depth 1 --branch "$VULNERABLE_TAG" "$REPO_URL" "$SOURCE_DIR"

if [ $? -eq 0 ]; then
    echo "Successfully cloned FlatPress $VULNERABLE_TAG to $SOURCE_DIR"
else
    echo "Failed to clone repository"
    exit 1
fi
