# CVE-2025-27140 Vulnerability Report

## Vulnerability Overview

- CVE ID: CVE-2025-27140
- CWE: CWE-78 (OS Command Injection)
- Affected Software: WeGIA < 3.2.15
- CVSS Score: 10.0 (Critical)

## Vulnerability Details

The importar_dump.php endpoint contains an OS Command Injection vulnerability. User-controlled filename is directly concatenated into shell_exec() without sanitization.

### Vulnerable Code

```php
$log = shell_exec("mv ". $_FILES["import"]["tmp_name"] . " " . BKP_DIR . $_FILES["import"]["name"]);
```

### Root Cause

1. No input sanitization on filename (no escapeshellarg)
2. Direct concatenation into shell command
3. No exit() after session check - code executes without authentication
4. Leading <pre> tag causes "headers already sent" preventing redirect

## PoC Verification (Time-based Blind Injection)

Multiple sleep tests confirm command execution:

| Test | Sleep Time | Response Time |
|------|------------|---------------|
| 1 | 1s | 1.16s |
| 2 | 3s | 3.02s |
| 3 | 5s | 5.16s |

Time differences:
- (sleep 3 - sleep 1): 1.86s (expected ~2s)
- (sleep 5 - sleep 3): 2.14s (expected ~2s)

Response times directly correlate with sleep durations, confirming command execution.

## Impact

- Remote Code Execution without authentication
- Full server compromise
- Webshell upload possible

## References

- https://github.com/LabRedesCefetRJ/WeGIA/security/advisories/GHSA-xw6w-x28r-2p5c
