#!/bin/bash

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
SOURCE_DIR="$SCRIPT_DIR/source_code"

REPO_URL="https://github.com/LabRedesCefetRJ/WeGIA.git"
VULNERABLE_TAG="3.4.1"

if [ -d "$SOURCE_DIR" ]; then
    echo "Removing existing source_code directory..."
    rm -rf "$SOURCE_DIR"
fi

echo "Cloning WeGIA repository..."
git clone "$REPO_URL" "$SOURCE_DIR"

cd "$SOURCE_DIR"
echo "Checking out vulnerable version $VULNERABLE_TAG..."
git checkout "tags/$VULNERABLE_TAG"

echo "Done. Source code is at: $SOURCE_DIR"
