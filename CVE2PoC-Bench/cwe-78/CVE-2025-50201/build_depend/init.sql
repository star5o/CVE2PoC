CREATE DATABASE IF NOT EXISTS wegia CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE wegia;

CREATE TABLE IF NOT EXISTS instituicao (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(255),
    cnpj VARCHAR(20),
    endereco VARCHAR(255),
    telefone VARCHAR(20)
);

CREATE TABLE IF NOT EXISTS pessoa (
    id_pessoa INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(255),
    login VARCHAR(100),
    senha VARCHAR(255),
    email VARCHAR(255),
    tipo INT DEFAULT 1
);

CREATE TABLE IF NOT EXISTS modulo (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(100),
    descricao TEXT
);

CREATE TABLE IF NOT EXISTS permissao (
    id INT PRIMARY KEY AUTO_INCREMENT,
    id_pessoa INT,
    id_modulo INT,
    FOREIGN KEY (id_pessoa) REFERENCES pessoa(id_pessoa),
    FOREIGN KEY (id_modulo) REFERENCES modulo(id)
);

INSERT INTO instituicao (nome, cnpj, endereco, telefone) VALUES 
('Test Institution', '12.345.678/0001-99', 'Test Address', '1234567890');

INSERT INTO pessoa (nome, login, senha, email, tipo) VALUES 
('Admin', 'admin', MD5('admin123'), 'admin@test.com', 1);

INSERT INTO modulo (nome, descricao) VALUES 
('Pessoas', 'Module for people management'),
('Material', 'Material management'),
('Memorando', 'Memo management'),
('Contribuicao', 'Contribution management'),
('Saude', 'Health management'),
('Pet', 'Pet management'),
('Relatorios', 'Reports'),
('Configuracoes', 'Settings'),
('Debug', 'Debug and development');

INSERT INTO permissao (id_pessoa, id_modulo) VALUES 
(1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (1, 9);
