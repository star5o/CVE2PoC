#!/bin/bash

REPO_URL="https://gitee.com/chancms/ChanCMS.git"
VULNERABLE_TAG="v3.1.2"
TARGET_DIR="$(dirname "$0")/source_code"

if [ -d "$TARGET_DIR" ]; then
    echo "Source code directory already exists, skipping..."
    exit 0
fi

echo "Cloning ChanCMS repository..."
git clone "$REPO_URL" "$TARGET_DIR"
cd "$TARGET_DIR"
git checkout "$VULNERABLE_TAG"
echo "Successfully checked out ChanCMS $VULNERABLE_TAG"
