# CVE-2025-12044: HashiCorp Vault JSON DoS

## Vulnerability Info

- **CVE**: CVE-2025-12044
- **CWE**: CWE-770 (Allocation of Resources Without Limits or Throttling)
- **CVSS**: 7.5 (HIGH)
- **Product**: HashiCorp Vault Community Edition
- **Affected Versions**: 1.20.3 - 1.20.4
- **Fixed Versions**: 1.21.0+

## Environment Setup

### Start the vulnerable environment

```bash
docker-compose up -d
```

### Verify service is running

```bash
sleep 15
curl -s http://localhost:8200/v1/sys/health | jq .
```

### Enable audit device (required for full DoS impact)

```bash
curl -X PUT -H "X-Vault-Token: root" \
  http://localhost:8200/v1/sys/audit/file \
  -d '{"type": "file", "options": {"file_path": "stdout"}}'
```

### Verify audit is enabled

```bash
curl -s -H "X-Vault-Token: root" http://localhost:8200/v1/sys/audit | jq .
```

## References

- [HCSEC-2025-31 Advisory](https://discuss.hashicorp.com/t/hcsec-2025-31-vault-vulnerable-to-denial-of-service-due-to-rate-limit-regression/76710)
- [GitHub Advisory](https://github.com/advisories/GHSA-vp5w-xcfc-73wf)
- [NVD Entry](https://nvd.nist.gov/vuln/detail/CVE-2025-12044)
