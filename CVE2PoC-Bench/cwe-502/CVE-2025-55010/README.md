# CVE-2025-55010: Kanboard Unsafe Deserialization RCE

## Vulnerability Information

- **CVE ID**: CVE-2025-55010
- **CWE**: CWE-502 (Deserialization of Untrusted Data)
- **CVSS Score**: 9.1 (Critical)
- **Affected Software**: Kanboard < 1.2.47
- **Vulnerability Type**: Unsafe Deserialization leading to Remote Code Execution

## Environment Setup

### Start the vulnerable environment

```bash
docker compose up -d
```

Wait for the service to be ready (about 30 seconds), then access http://127.0.0.1:8080

### Default credentials

- Username: `admin`
- Password: `admin`

### Stop and clean up

```bash
docker compose down -v
```

## Exploitation

The exploit chain:

1. Login as admin
2. Create a project to generate activity data
3. Download SQLite database via admin panel (`/ConfigController/downloadDb`)
4. Inject SwiftMailer/FW4 gadget chain into `project_activities.data` field
5. Upload modified database via admin panel (`/ConfigController/saveUploadedDb`)
6. Trigger `unserialize()` by accessing project activity page
7. Gadget chain writes webshell to `/plugins/shell.php`
8. Verify RCE

## Vulnerability Details

The vulnerability exists in `app/Formatter/ProjectActivityEventFormatter.php`:

```php
protected function unserializeEvent($data)
{
    if ($data[0] === 'a') {
        return unserialize($data);  // Vulnerable: no validation
    }
    return json_decode($data, true) ?: array();
}
```

## Gadget Chain

SwiftMailer/FW4 gadget chain:

```
Swift_Transport_SendmailTransport::__destruct()
  -> stop()
  -> executeCommand("QUIT\r\n")
  -> _buffer->write()
  -> Swift_ByteStream_FileByteStream writes webshell
```

## Mitigation

Upgrade Kanboard to version 1.2.47 or later.
