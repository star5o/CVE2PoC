#!/bin/bash

REPO_URL="https://github.com/moxi624/mogu_blog_v2.git"
VULNERABLE_TAG="v5.2"
TARGET_DIR="$(dirname "$0")/source_code"

if [ -d "$TARGET_DIR" ]; then
    echo "Source code directory already exists. Removing..."
    rm -rf "$TARGET_DIR"
fi

echo "Cloning mogu_blog_v2 repository..."
git clone --depth 1 --branch Nacos "$REPO_URL" "$TARGET_DIR"

cd "$TARGET_DIR"
echo "Checking out to Nacos branch (contains vulnerable version up to 5.2)..."

echo "Done. Source code is available at: $TARGET_DIR"
echo "Vulnerable file: mogu_picture/src/main/java/com/moxi/mogublog/picture/service/impl/LocalFileServiceImpl.java"
