#!/bin/bash

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
SOURCE_DIR="$SCRIPT_DIR/source_code"

REPO_URL="https://github.com/qinguoyi/TinyWebServer.git"
VULNERABLE_TAG="master"

if [ -d "$SOURCE_DIR" ]; then
    echo "source_code directory exists, removing..."
    rm -rf "$SOURCE_DIR"
fi

echo "Cloning $REPO_URL..."
git clone "$REPO_URL" "$SOURCE_DIR"

cd "$SOURCE_DIR"
git checkout "$VULNERABLE_TAG"

echo "Source code ready at $SOURCE_DIR"
