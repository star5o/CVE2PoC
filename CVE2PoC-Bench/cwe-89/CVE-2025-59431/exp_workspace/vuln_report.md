# CVE-2025-59431 Vulnerability Report

## Overview
- **CVE ID**: CVE-2025-59431
- **CWE**: CWE-89 (SQL Injection)
- **CVSS Score**: 9.8 (Critical)
- **Affected Software**: MapServer < 8.4.1
- **Vulnerability Type**: Boolean-based SQL Injection

## Description
MapServer WFS (Web Feature Service) contains a SQL injection vulnerability in the XML Filter Query directive. The PropertyName element fails to properly sanitize double quote characters, allowing attackers to manipulate backend database queries and bypass filter conditions.

## Technical Details

### Vulnerable Component
- WFS GetFeature request handler
- XML Filter encoding parser (PropertyIsLike)
- PropertyName element processing

### Attack Vector
Network-based attack via WFS POST requests. No authentication required.

### Successful Payload (PostgreSQL backend)

```
PropertyName: "~'.'OR"
```

### SQL Transformation

The double quotes in PropertyName are converted to brackets:
- Input: `"~'.'OR"`
- Output SQL condition: `('[' ~ '.' or TRUE or ']' ~ '^pattern$')`

### Why It Works

1. `'[' ~ '.'` - PostgreSQL regex match: bracket matches "any single character" pattern
2. This evaluates to `TRUE`
3. The entire condition becomes `TRUE or TRUE or FALSE = TRUE`
4. Filter is bypassed, returning all records

### Exploitation Result

- Normal query with impossible match: 0 records
- Injection payload with same match condition: 10 records (all data)
- Sensitive data exposed without authorization

## Impact
- Complete filter bypass
- Unauthorized data access
- Information disclosure
- CVSS 9.8 Critical

## Remediation
Upgrade to MapServer 8.4.1 or later.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2025-59431
- https://github.com/MapServer/MapServer/security/advisories/GHSA-256m-rx4h-r55w
