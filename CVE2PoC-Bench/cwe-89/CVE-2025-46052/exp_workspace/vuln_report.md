# CVE-2025-46052 Vulnerability Report

## Vulnerability Overview

- **CVE ID**: CVE-2025-46052
- **CWE ID**: CWE-89 (SQL Injection)
- **Affected Software**: WebERP v4.15.2
- **Vulnerability Type**: Error-based SQL Injection
- **CVSS Score**: 9.8 (Critical)

## Technical Details

### Vulnerable Endpoint

- **URL**: `/StockCounts.php?Action=View`
- **Method**: POST
- **Parameter**: `DEL` (form field name/key)

### Vulnerable Code

The vulnerability exists in `StockCounts.php` at approximately line 355:

```php
foreach ($_POST['DEL'] as $id=>$val){
    if ($val == 'on'){
        $sql = "DELETE FROM stockcounts WHERE id='".$id."'";
        $ErrMsg = _('Failed to delete StockCount ID #').' '.$i;
        $EnterResult = DB_query($sql,$ErrMsg);
    }
}
```

The `$id` variable is derived from the key of the `$_POST['DEL']` array and is directly concatenated into the SQL query without any sanitization or parameterization.

### Attack Vector

An authenticated attacker can inject SQL commands through the `DEL` form field name using multipart/form-data encoding.

### Payload Example

```
DEL[8' AND EXTRACTVALUE(1,CONCAT(0x7e,(SELECT table_name FROM information_schema.tables WHERE table_schema='weberpdemo' LIMIT 1 OFFSET 0)))-- ]=on
```

## Impact

- Execute arbitrary SQL commands
- Extract sensitive database information (usernames, passwords, financial data)
- Modify or delete database records
- Potential for full database compromise

## Proof of Concept

Successfully extracted table name `accountgroups` from the `weberpdemo` database using error-based SQL injection technique with EXTRACTVALUE function.

## Remediation

1. Use parameterized queries/prepared statements
2. Validate and sanitize the `$id` variable before use
3. Implement input validation to ensure `$id` is numeric
4. Upgrade to a patched version of WebERP

## References

- https://github.com/johnchd/CVEs/blob/main/WebERP/CVE-2025-46052%20-%20SQLi.md
- https://github.com/timschofield/webERP/pull/401
