<?php
header('Content-Type: application/json');

require_once('/var/www/adodb/adodb.inc.php');

$db = ADONewConnection('postgres9');
$db->Connect('db', 'postgres', 'postgres', 'testdb');

$table = $_REQUEST['table'] ?? '';
$field = $_REQUEST['field'] ?? '';

if (empty($table) || empty($field)) {
    echo json_encode(['error' => 'Missing table or field parameter']);
    exit;
}

$result = $db->pg_insert_id($table, $field);

echo json_encode([
    'table' => $table,
    'field' => $field,
    'last_insert_id' => $result
]);
