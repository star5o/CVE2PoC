# CVE-2025-32968 Vulnerability Report

## Vulnerability Information

- **CVE ID**: CVE-2025-32968
- **Type**: SQL Injection (CWE-89)
- **CVSS v4.0**: 8.6 (HIGH)
- **Affected Product**: XWiki Platform
- **Affected Versions**: 
  - >= 1.6-milestone-1, < 15.10.16
  - >= 16.0.0-rc-1, < 16.4.6
  - >= 16.5.0-rc-1, < 16.10.1

## Vulnerability Description

XWiki allows users with SCRIPT right to escape from the HQL execution context and perform a blind SQL injection to execute arbitrary SQL statements on the database backend.

Depending on the used database backend, the attacker may be able to:
- Obtain confidential information such as password hashes
- Execute UPDATE/INSERT/DELETE queries
- Access sensitive data from xwikistrings table

## Exploitation Requirements

- Valid XWiki user account with SCRIPT rights
- Access to create or edit wiki pages with Velocity macros

## Proof of Concept

The vulnerability is triggered through the `$services.query.hql()` API in Velocity scripts:

```velocity
{{velocity}}
$services.query.hql("where 1<>'1\'' union select concat(XWS_NAME, XWS_VALUE) from xwikistrings #'").execute()
{{/velocity}}
```

This payload uses SQL UNION injection to extract data from the xwikistrings table, which contains sensitive string fields including passwords.

## Remediation

Upgrade XWiki to one of the patched versions:
- 15.10.16
- 16.4.6
- 16.10.1

## References

- https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-g9jj-75mx-wjcx
- https://jira.xwiki.org/browse/XWIKI-22718
