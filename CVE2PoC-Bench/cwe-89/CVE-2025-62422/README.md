# CVE-2025-62422 - DataEase SQL Injection

## Environment Setup

### Requirements

- Docker and Docker Compose
- 4GB+ available RAM
- Python 3.x with requests

### Start Environment

```bash
cd cwe-89/CVE-2025-62422
docker-compose up -d
```

Wait 3-5 minutes for all services to initialize.

### Service Status Check

```bash
docker ps --filter "name=cve-2025-62422"
```

Expected output: 3 containers (mysql, elasticsearch, dataease) all healthy.

### Access

- Web UI: http://localhost:8100
- Credentials: admin / DataEase@123456
- Elasticsearch: http://localhost:9200

### Create Elasticsearch Index (Required)

```bash
curl -X PUT "http://localhost:9200/testindex" -H 'Content-Type: application/json' -d '{"mappings":{"properties":{"name":{"type":"text"},"value":{"type":"integer"}}}}'
curl -X POST "http://localhost:9200/testindex/_doc" -H 'Content-Type: application/json' -d '{"name":"test_data","value":100}'
```

### Get Authentication Token

1. Login via browser at http://localhost:8100
2. Open browser DevTools (F12) -> Console
3. Run: `JSON.parse(localStorage.getItem('user.token')).v.replace(/"/g, '')`
4. Copy the JWT token

### Stop Environment

```bash
docker-compose down -v
```

## Vulnerability Details

- **CVE:** CVE-2025-62422
- **CWE:** CWE-89 (SQL Injection)
- **Affected:** DataEase <= 2.10.13
- **Fixed:** DataEase 2.10.14
- **Endpoint:** `/de2api/datasetData/tableField`
- **Parameter:** `info.table`

## Notes

1. DataEase uses complex AES+RSA encryption for login passwords
2. Authentication is required to exploit this vulnerability
3. An Elasticsearch datasource must be configured
4. The vulnerability is in `EsProvider.java` line 98
