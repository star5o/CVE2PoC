# CVE-2025-44830 Vulnerability Report

## Overview

- **CVE ID**: CVE-2025-44830
- **Vulnerability Type**: SQL Injection (CWE-89)
- **CVSS Score**: 9.8 (Critical)
- **Affected Software**: EngineerCMS v1.02 through v2.0.5
- **Vendor**: https://github.com/3xxx/engineercms

## Vulnerability Description

EngineerCMS contains a SQL injection vulnerability in the `/project/addprojtemplet` interface. The vulnerability exists due to improper sanitization of user input in the `code` and `name` parameters, which are directly concatenated into SQL queries.

## Technical Details

### Vulnerable Code Location

File: `models/ProjModel.go`, function `Insertprojtemplet`

```go
sql := fmt.Sprintf("insert into Project (Code, Title, Label, Principal, Parent_id, Parent_id_path, Parent_title_path, Grade,Created,Updated)"+
    " values('%s','%s','%s','%s',%d,'%s','%s',%d,'%s','%s')", code, title, "", "", parentid, parentidpath, parenttitlepath, grade, date, date)
res, err := o.Raw(sql).Exec()
```

The `code` and `title` parameters are directly interpolated into the SQL query using `fmt.Sprintf` without any sanitization or parameterization.

### Attack Vector

- **Endpoint**: POST `/project/addprojtemplet`
- **Vulnerable Parameters**: `code`, `name`
- **Authentication**: Required (admin role)
- **Injection Type**: Time-based Blind SQL Injection

### Proof of Concept

The vulnerability can be exploited using time-based blind SQL injection with SQLite's `randomblob()` function:

```
code=TEST' || (SELECT CASE WHEN 1=1 THEN randomblob(300000000) ELSE 0 END) || '
```

When the condition is true, the response is delayed significantly (15-20 seconds) due to the `randomblob()` call.

## Impact

- **Confidentiality**: An attacker can extract sensitive data from the database
- **Integrity**: An attacker can modify or delete database records
- **Availability**: An attacker can cause denial of service through heavy queries

## Remediation

1. Use parameterized queries instead of string concatenation:

```go
sql := "INSERT INTO Project (Code, Title, ...) VALUES (?, ?, ...)"
res, err := o.Raw(sql, code, title, ...).Exec()
```

2. Implement input validation and sanitization
3. Apply the principle of least privilege to database accounts

## References

- https://github.com/3xxx/engineercms/issues/90
- https://gist.github.com/LTLTLXEY/e00ec21b730742ef432a7a560cd9b70a
