# CVE-2025-56588 Vulnerability Report

## Basic Information

| Field | Value |
|-------|-------|
| CVE ID | CVE-2025-56588 |
| Affected Product | Dolibarr ERP & CRM |
| Affected Version | 21.0.1 |
| Fixed Version | 21.0.3 |
| Vulnerability Type | Remote Code Execution (RCE) |
| CWE | CWE-94 (Improper Control of Generation of Code) |
| CVSS 3.1 Score | 8.8 (HIGH) |

## Description

Dolibarr ERP & CRM v21.0.1 contains a remote code execution vulnerability in the User module configuration via the computed field parameter. This vulnerability is a bypass for previous protections implemented for CVE-2024-40137.

## Technical Analysis

### Vulnerability Location

The vulnerability exists in the computed field functionality for user extra fields. When an administrator creates or modifies a computed field, the expression is evaluated using the `dol_eval()` function during page rendering.

### Code Flow

1. Admin creates extrafield at `/user/admin/user_extrafields.php`
2. Computed field value stored in database
3. When user list is rendered, `dol_eval()` evaluates the expression
4. Evaluation occurs in `htdocs/core/class/commonobject.class.php` and related templates

### dol_eval() Function Analysis

Location: `htdocs/core/lib/functions.lib.php` (line 10710)

The function uses `onlysimplestring = '2'` mode for computed fields, which allows:
- Alphanumeric characters
- Special characters: `^$_+-.*>&|=!?():"\',/@<[]`
- Method calls: `->method()`
- Object instantiation: `new ClassName()`

### Security Filters

1. **Character Whitelist**: Only allows specific characters
2. **Dot Restriction**: `/[^0-9]+\.[^0-9]+/` - blocks dot between non-digits
3. **Double Colon**: `::` is forbidden
4. **Dynamic Calls**: `$var(` pattern is blocked
5. **Function Blacklist**: exec, system, shell_exec, file_put_contents, eval, include, require, etc.

### Verified Behavior

Testing confirmed that expressions like `$objectoffield->id` are successfully evaluated, returning the user ID when viewing the user list. This proves the code evaluation path is active.

## Impact

An authenticated administrator can potentially execute arbitrary code on the server by crafting a malicious computed field expression that bypasses the security filters.

- **Confidentiality**: HIGH - Potential access to sensitive data
- **Integrity**: HIGH - Potential modification of system data
- **Availability**: HIGH - Potential system compromise

## Prerequisites

1. Administrator account on Dolibarr
2. Access to User module settings
3. Ability to create/modify extra fields

## Reproduction Steps

1. Login as administrator
2. Navigate to Setup > Users and Groups > Custom attributes (Users)
3. Create new attribute with computed field containing malicious payload
4. Access user list page to trigger evaluation

## Remediation

- Update to Dolibarr version 21.0.3 or later
- The patch commit: `b03f30c7e27fb89dbfb15902dbf4619ae77f0f86`

## References

- https://nvd.nist.gov/vuln/detail/CVE-2025-56588
- https://github.com/PhDg1410/Research
- https://github.com/Dolibarr/dolibarr/commit/b03f30c7e27fb89dbfb15902dbf4619ae77f0f86
