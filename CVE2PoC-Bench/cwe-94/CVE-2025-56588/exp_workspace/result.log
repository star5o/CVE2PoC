CVE-2025-56588 Dolibarr ERP & CRM v21.0.1 RCE Test Results
============================================================

Date: 2026-02-04
Target: Dolibarr ERP & CRM v21.0.1

[1] Environment Setup
---------------------
Docker containers successfully started:
- cve-2025-56588-web-1 (dolibarr/dolibarr:21.0.1) - Port 8088
- cve-2025-56588-mariadb-1 (mariadb:latest)

Access URL: http://127.0.0.1:8088
Admin credentials: admin / admin123

[2] Login Test
--------------
Result: SUCCESS
Admin login successful via browser automation

[3] Vulnerability Analysis
--------------------------
Location: /user/admin/user_extrafields.php
Feature: Computed field in User module extra fields
Function: dol_eval() in htdocs/core/lib/functions.lib.php

dol_eval() Parameters for computed fields:
- returnvalue: 1
- hideerrors: 0
- onlysimplestring: '2' (allows additional chars: <[])

[4] dol_eval() Filter Analysis
------------------------------
Mode '2' Allowed Characters: a-zA-Z0-9 + ^$_+-.*>&|=!?():"\',/@<[] + whitespace

Key Restrictions:
- Dot (.) forbidden unless between two numbers: /[^0-9]+\.[^0-9]+/
- Double colon (::) forbidden
- Backtick (`) forbidden
- Dynamic calls ($var() pattern forbidden
- Function blacklist includes: exec, system, shell_exec, file_put_contents,
  eval, include, require, include_once, require_once, etc.

Allowed Patterns:
- Method calls: ->method()
- Function calls: functionName()
- Object creation: new ClassName()
- Global variables: $db, $conf, $user, $objectoffield, $object, etc.

[5] Payload Testing
-------------------
Test 1: $objectoffield->id
Result: SUCCESS
Explanation: Returns user ID (1) when viewing user list
This proves dol_eval() executes the computed field expression

Test 2: Menu perms field with $db->query()
Result: PARTIAL - Quotes were stripped during save

[6] Conclusions
---------------
VERIFIED:
- Computed field expressions ARE evaluated via dol_eval()
- Method calls using -> syntax are allowed and executed
- The vulnerability entry point exists as described in CVE

LIMITATIONS OBSERVED:
- Dot character restriction prevents file path construction
- Function blacklist blocks common RCE functions
- String concatenation using . is blocked

BYPASS REQUIREMENTS:
CVE-2025-56588 is documented as a bypass for CVE-2024-40137 protections.
The specific bypass technique to achieve full RCE requires:
1. Constructing file paths without using dot characters between non-digits
2. Finding functions not in the blacklist that can execute code
3. Potentially using object method chains to achieve code execution

REFERENCES:
- Patch commit: github.com/Dolibarr/dolibarr/commit/b03f30c7e27fb89dbfb15902dbf4619ae77f0f86
- Research: github.com/PhDg1410/Research
- Fixed in: Dolibarr 21.0.3

[7] Environment Cleanup
-----------------------
Docker containers stopped and removed.
