# CVE-2024-47051 Reproduction Environment

Mautic Remote Code Execution via Asset Upload vulnerability reproduction environment.

## Prerequisites

- Docker and Docker Compose
- Python 3.x with requests library

## Environment Setup

### 1. Start the Environment

```bash
docker-compose up -d
```

Wait approximately 2 minutes for Mautic to initialize.

### 2. Install Mautic

Run the CLI installation command:

```bash
echo "yes" | docker exec -i cve-2024-47051-mautic-1 php /var/www/html/bin/console mautic:install http://localhost:8080 \
  --admin_email="admin@mautic.local" \
  --admin_password="Mautic123!" \
  --db_host=db \
  --db_port=3306 \
  --db_name=mautic \
  --db_user=mautic \
  --db_password=mautic
```

### 3. Update Admin Password

The default password is weak and will be rejected by Mautic. Update it:

```bash
HASH=$(docker exec cve-2024-47051-mautic-1 php -r "echo password_hash('Mautic@2026!Secure', PASSWORD_BCRYPT);")
docker exec cve-2024-47051-db-1 mysql -umautic -pmautic mautic -e "UPDATE users SET password='$HASH' WHERE username='admin';"
```

### 4. Remove .htaccess Protection

For RCE exploitation, remove the .htaccess file that blocks PHP execution:

```bash
docker exec cve-2024-47051-mautic-1 rm -f /var/www/html/docroot/media/files/.htaccess
```

## Credentials

- **URL**: http://localhost:8080
- **Username**: admin
- **Password**: Mautic@2026!Secure

## Environment Details

- Mautic Version: 5.2.0 (vulnerable)
- Database: MySQL 8.0
- Web Server: Nginx + PHP-FPM

## Stopping the Environment

```bash
docker-compose down -v
```
