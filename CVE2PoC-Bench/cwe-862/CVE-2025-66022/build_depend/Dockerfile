FROM tomcat:9-jre11

RUN apt-get update && apt-get upgrade -y && apt-get install -y curl
RUN mkdir /opt/faction
RUN sed -i 's/^jdk.tls.disabledAlgorithms/# jdk.tls.disabledAlgorithms/' /opt/java/openjdk/conf/security/java.security

RUN rm -rf /usr/local/tomcat/webapps/manager
RUN rm -rf /usr/local/tomcat/webapps/host-manager
RUN rm -rf /usr/local/tomcat/webapps/docs
RUN rm -rf /usr/local/tomcat/webapps/examples
RUN rm -rf /usr/local/tomcat/webapps/ROOT

RUN wget https://github.com/factionsecurity/faction/releases/download/1.7.0/faction.war -O /usr/local/tomcat/webapps/ROOT.war

EXPOSE 8080/tcp
CMD ["/usr/local/tomcat/bin/catalina.sh", "run"]
