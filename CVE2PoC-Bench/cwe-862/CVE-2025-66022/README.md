# CVE-2025-66022 Reproduction Environment

FACTION Unauthenticated Extension Management Access Leading to RCE

## Environment Setup

1. Start the environment:

```bash
docker-compose up -d --build
```

2. Wait for the FACTION service to start (about 1-2 minutes), then access http://localhost:8088

3. Complete initial setup:
   - Access http://localhost:8088
   - Fill in the admin account information:
     - Username: admin
     - Password: Admin123!
     - Email: admin@test.com
     - First Name: Admin
     - Last Name: User
   - Click Save to finish setup

4. The vulnerable `/portal/AppStoreDashboard` endpoint is now accessible without authentication due to the flawed authorization logic when `FACTION_APPSTORE_ENABLED` is not set to "true"

## Vulnerability Details

The vulnerability exists in the authorization check:
- When `FACTION_APPSTORE_ENABLED` is not "true", the condition `isAppStoreEnabled() && !isAcadmin()` evaluates to `false`
- This causes the authorization method to return `null`, bypassing authentication
- An attacker can access extension management and upload malicious extensions
- When lifecycle hooks are triggered by legitimate users, RCE occurs

## Cleanup

```bash
docker-compose down -v
```
