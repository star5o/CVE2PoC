# CVE-2025-29926 - XWiki WikiManager REST API Authorization Bypass

## Vulnerability Information

- **CVE**: CVE-2025-29926
- **CWE**: CWE-862 (Missing Authorization)
- **CVSS**: 7.9 (HIGH)
- **Affected**: XWiki < 15.10.15, < 16.4.6, < 16.10.0

## Environment Setup

### 1. Start the Environment

```bash
docker-compose up -d
```

Wait for XWiki to fully initialize (2-3 minutes on first run).

### 2. Complete Initial Configuration

Access http://localhost:18080/ and complete the Distribution Wizard:

1. Click "Continue" to start the wizard
2. Create admin account (Username: Admin, Password: admin123)
3. Click "Register and login"
4. For Flavor step, click "Let the wiki be empty" then "Continue"
5. Click "Continue" on the Report page to finish

### 3. Install WikiManager REST Extension

The vulnerable component is NOT bundled by default. Install via REST API:

```bash
curl -u "Admin:admin123" -X PUT \
  "http://localhost:18080/rest/wikis/xwiki/spaces/Main/pages/InstallExt" \
  -H "Content-Type: application/xml" \
  -d '<?xml version="1.0"?>
<page xmlns="http://www.xwiki.org">
  <title>Install Extension</title>
  <syntax>xwiki/2.1</syntax>
  <content>{{groovy}}
def job = services.extension.install(
  services.extension.createInstallRequest(
    "org.xwiki.platform:xwiki-platform-wiki-rest-default",
    "16.4.0", "wiki:xwiki").tap { it.interactive = false })
job?.join()
println job ? "Installed" : "Failed"
{{/groovy}}</content>
</page>'
```

Then visit http://localhost:18080/bin/view/Main/InstallExt to execute the installation.

### 4. Verify Extension Installed

```bash
curl http://localhost:18080/rest/wikimanager
```

- 302/404: Extension not installed
- 405 (Allow: POST): Extension is available

## Stop Environment

```bash
docker-compose down -v
```
ept any prompts and wait for installation

#### Option B: Via Groovy Script

1. Login as Admin
2. Create a new page (e.g., Main.InstallExtension)
3. Edit in Wiki mode and add:

```
{{groovy}}
def installRequest = services.extension.createInstallRequest(
    "org.xwiki.platform:xwiki-platform-wiki-rest-default",
    "16.4.0",
    "wiki:xwiki"
)
installRequest.setInteractive(false)
def job = services.extension.install(installRequest)
if (job) {
    job.join()
    println "Installation complete"
}
{{/groovy}}
```

4. Save and view the page (requires Programming Rights)

### 4. Verify Extension Installed

```bash
curl http://localhost:18080/rest/wikimanager
```

- If 404: Extension not installed
- If 200/other response: Extension is available

## Stop Environment

```bash
docker-compose down -v
```

## Notes

- This vulnerability requires the WikiManager REST API extension to be installed
- The REST API path is `/rest/` (not `/xwiki/rest/`)
- Default credentials after setup: Admin / admin123
